<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_9VJN118OUIRCdj4Q5s6GTT"><span id="%24maxtag_7cEO4pES4caBTCsJ6izoVu"><span id="%24tag2con_7cEO4pES4caBTCsJ6izoVu"><span id="%24con2tag_7cEO4pES4caBTCsJ6izoVu"><span id="%24con2tag_DRWn2UEydZ1Il9zWbEeoJU"><span id="%24con2tag_kep0kXNeubJZR8NTvLasF"><span id="%24maxtag_8Etfm0UnFOTAqFf2q8odWG"><span id="%24tag2con_8Etfm0UnFOTAqFf2q8odWG"><span id="%24con2tag_8Etfm0UnFOTAqFf2q8odWG"></span></span></span></span></span></span></span></span></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-type-defaults #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">APRS.Types</span><span>
</span><span id="line-5"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="APRS.Types.html#PacketType"><span class="hs-identifier">PacketType</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier">Address</span></a></span><span>
</span><span id="line-7"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#address"><span class="hs-identifier">address</span></a></span><span>
</span><span id="line-8"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#unAddress"><span class="hs-identifier">unAddress</span></a></span><span>
</span><span id="line-9"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#Similar"><span class="hs-identifier">Similar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#%2248"><span class="hs-operator">(&#8776;)</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#elemish"><span class="hs-identifier">elemish</span></a></span><span>
</span><span id="line-10"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#Frame"><span class="hs-identifier">Frame</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier">Position</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#Timestamp"><span class="hs-identifier">Timestamp</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#WeatherParam"><span class="hs-identifier">WeatherParam</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#WeatherSW"><span class="hs-identifier">WeatherSW</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#WeatherUnit"><span class="hs-identifier">WeatherUnit</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier">identifyPacket</span></a></span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#callPass"><span class="hs-identifier">callPass</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#decodeBase91"><span class="hs-identifier">decodeBase91</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#symbol"><span class="hs-identifier">symbol</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#distance"><span class="hs-identifier">distance</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-comment">-- New parser</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier">APRSPacket</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#PosExtension"><span class="hs-identifier">PosExtension</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#Symbol"><span class="hs-identifier">Symbol</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#Directivity"><span class="hs-identifier">Directivity</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#MessageInfo"><span class="hs-identifier">MessageInfo</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#ObjectState"><span class="hs-identifier">ObjectState</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#ObjectData"><span class="hs-identifier">ObjectData</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#Capability"><span class="hs-identifier">Capability</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#position"><span class="hs-identifier">position</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-comment">-- parsers</span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#parseAddr"><span class="hs-identifier">parseAddr</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#parseFrame"><span class="hs-identifier">parseFrame</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#parseTimestamp"><span class="hs-identifier">parseTimestamp</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#parseWeather"><span class="hs-identifier">parseWeather</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#bodyParser"><span class="hs-identifier">bodyParser</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-comment">-- For testing</span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#lookupWeatherSW"><span class="hs-identifier">lookupWeatherSW</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">guard</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">replicateM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">replicateM_</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Attoparsec.Text</span></span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">A</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">shiftL</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">xor</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.&amp;.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">digitToInt</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toLower</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Foldable</span></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">any</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Functor</span></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">($&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span>                          </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int16</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromString</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">all</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">any</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">length</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unpack</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Word8</span></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Geodetics.Geodetic</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Geodetic</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">WGS84</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">groundDistance</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Numeric</span></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readInt</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Numeric.Units.Dimensional</span></span><span>         </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(*~)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(/~)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_0</span></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Numeric.Units.Dimensional.SIUnits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">degree</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">meter</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Text.Read</span></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">readMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="APRS.MicE.html"><span class="hs-identifier">APRS.MicE</span></a></span><span>                         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="APRS.NMEA.html"><span class="hs-identifier">APRS.NMEA</span></a></span><span>                         </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">N</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">class</span><span> </span><span id="Similar"><span class="annot"><a href="APRS.Types.html#Similar"><span class="hs-identifier hs-var">Similar</span></a></span></span><span> </span><span id="local-6989586621679078487"><span class="annot"><a href="#local-6989586621679078487"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-63"></span><span>  </span><span id="%2248"><span class="annot"><a href="APRS.Types.html#%2248"><span class="hs-operator hs-type">(&#8776;)</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679078487"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078487"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span id="local-6989586621679078273"><span id="local-6989586621679078274"><span class="annot"><a href="APRS.Types.html#elemish"><span class="hs-identifier hs-type">elemish</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Foldable</span></span><span> </span><span class="annot"><a href="#local-6989586621679078274"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#Similar"><span class="hs-identifier hs-type">Similar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078273"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078273"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679078274"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679078273"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-66"></span><span id="elemish"><span class="annot"><span class="annottext">elemish :: a -&gt; f a -&gt; Bool
</span><a href="APRS.Types.html#elemish"><span class="hs-identifier hs-var hs-var">elemish</span></a></span></span><span> </span><span id="local-6989586621679078272"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078272"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; f a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">Data.Foldable.any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Similar a =&gt; a -&gt; a -&gt; Bool
</span><a href="APRS.Types.html#%2248"><span class="hs-operator hs-var">&#8776;</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679078272"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">data</span><span> </span><span id="PacketType"><span class="annot"><a href="APRS.Types.html#PacketType"><span class="hs-identifier hs-var">PacketType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CurrentMicEBin"><span class="annot"><a href="APRS.Types.html#CurrentMicEBin"><span class="hs-identifier hs-var">CurrentMicEBin</span></a></span></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="CurrentMicE"><span class="annot"><a href="APRS.Types.html#CurrentMicE"><span class="hs-identifier hs-var">CurrentMicE</span></a></span></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Item"><span class="annot"><a href="APRS.Types.html#Item"><span class="hs-identifier hs-var">Item</span></a></span></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PositionNoTSNoMsg"><span class="annot"><a href="APRS.Types.html#PositionNoTSNoMsg"><span class="hs-identifier hs-var">PositionNoTSNoMsg</span></a></span></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PositionTSNoMsg"><span class="annot"><a href="APRS.Types.html#PositionTSNoMsg"><span class="hs-identifier hs-var">PositionTSNoMsg</span></a></span></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MessagePkt"><span class="annot"><a href="APRS.Types.html#MessagePkt"><span class="hs-identifier hs-var">MessagePkt</span></a></span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Object"><span class="annot"><a href="APRS.Types.html#Object"><span class="hs-identifier hs-var">Object</span></a></span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="StationCaps"><span class="annot"><a href="APRS.Types.html#StationCaps"><span class="hs-identifier hs-var">StationCaps</span></a></span></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PositionNoTS"><span class="annot"><a href="APRS.Types.html#PositionNoTS"><span class="hs-identifier hs-var">PositionNoTS</span></a></span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PositionNoMsg"><span class="annot"><a href="APRS.Types.html#PositionNoMsg"><span class="hs-identifier hs-var">PositionNoMsg</span></a></span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PositionMsg"><span class="annot"><a href="APRS.Types.html#PositionMsg"><span class="hs-identifier hs-var">PositionMsg</span></a></span></span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RawGPSOrUlt"><span class="annot"><a href="APRS.Types.html#RawGPSOrUlt"><span class="hs-identifier hs-var">RawGPSOrUlt</span></a></span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Status"><span class="annot"><a href="APRS.Types.html#Status"><span class="hs-identifier hs-var">Status</span></a></span></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Query"><span class="annot"><a href="APRS.Types.html#Query"><span class="hs-identifier hs-var">Query</span></a></span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Telemetry"><span class="annot"><a href="APRS.Types.html#Telemetry"><span class="hs-identifier hs-var">Telemetry</span></a></span></span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="WeatherNoPos"><span class="annot"><a href="APRS.Types.html#WeatherNoPos"><span class="hs-identifier hs-var">WeatherNoPos</span></a></span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="UserDefined"><span class="annot"><a href="APRS.Types.html#UserDefined"><span class="hs-identifier hs-var">UserDefined</span></a></span></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="ThirdParty"><span class="annot"><a href="APRS.Types.html#ThirdParty"><span class="hs-identifier hs-var">ThirdParty</span></a></span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="InvalidPacket"><span class="annot"><a href="APRS.Types.html#InvalidPacket"><span class="hs-identifier hs-var">InvalidPacket</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078247"><span id="local-6989586621679078249"><span id="local-6989586621679078251"><span class="annot"><span class="annottext">Int -&gt; PacketType -&gt; ShowS
[PacketType] -&gt; ShowS
PacketType -&gt; String
(Int -&gt; PacketType -&gt; ShowS)
-&gt; (PacketType -&gt; String)
-&gt; ([PacketType] -&gt; ShowS)
-&gt; Show PacketType
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PacketType] -&gt; ShowS
$cshowList :: [PacketType] -&gt; ShowS
show :: PacketType -&gt; String
$cshow :: PacketType -&gt; String
showsPrec :: Int -&gt; PacketType -&gt; ShowS
$cshowsPrec :: Int -&gt; PacketType -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679078231"><span id="local-6989586621679078233"><span id="local-6989586621679078235"><span id="local-6989586621679078237"><span id="local-6989586621679078239"><span id="local-6989586621679078241"><span id="local-6989586621679078243"><span class="annot"><span class="annottext">Eq PacketType
Eq PacketType
-&gt; (PacketType -&gt; PacketType -&gt; Ordering)
-&gt; (PacketType -&gt; PacketType -&gt; Bool)
-&gt; (PacketType -&gt; PacketType -&gt; Bool)
-&gt; (PacketType -&gt; PacketType -&gt; Bool)
-&gt; (PacketType -&gt; PacketType -&gt; Bool)
-&gt; (PacketType -&gt; PacketType -&gt; PacketType)
-&gt; (PacketType -&gt; PacketType -&gt; PacketType)
-&gt; Ord PacketType
PacketType -&gt; PacketType -&gt; Bool
PacketType -&gt; PacketType -&gt; Ordering
PacketType -&gt; PacketType -&gt; PacketType
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: PacketType -&gt; PacketType -&gt; PacketType
$cmin :: PacketType -&gt; PacketType -&gt; PacketType
max :: PacketType -&gt; PacketType -&gt; PacketType
$cmax :: PacketType -&gt; PacketType -&gt; PacketType
&gt;= :: PacketType -&gt; PacketType -&gt; Bool
$c&gt;= :: PacketType -&gt; PacketType -&gt; Bool
&gt; :: PacketType -&gt; PacketType -&gt; Bool
$c&gt; :: PacketType -&gt; PacketType -&gt; Bool
&lt;= :: PacketType -&gt; PacketType -&gt; Bool
$c&lt;= :: PacketType -&gt; PacketType -&gt; Bool
&lt; :: PacketType -&gt; PacketType -&gt; Bool
$c&lt; :: PacketType -&gt; PacketType -&gt; Bool
compare :: PacketType -&gt; PacketType -&gt; Ordering
$ccompare :: PacketType -&gt; PacketType -&gt; Ordering
$cp1Ord :: Eq PacketType
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679078226"><span id="local-6989586621679078228"><span class="annot"><span class="annottext">PacketType -&gt; PacketType -&gt; Bool
(PacketType -&gt; PacketType -&gt; Bool)
-&gt; (PacketType -&gt; PacketType -&gt; Bool) -&gt; Eq PacketType
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PacketType -&gt; PacketType -&gt; Bool
$c/= :: PacketType -&gt; PacketType -&gt; Bool
== :: PacketType -&gt; PacketType -&gt; Bool
$c== :: PacketType -&gt; PacketType -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-type">identifyPacket</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="APRS.Types.html#PacketType"><span class="hs-identifier hs-type">PacketType</span></a></span><span>
</span><span id="line-90"></span><span id="identifyPacket"><span class="annot"><span class="annottext">identifyPacket :: Char -&gt; PacketType
</span><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var hs-var">identifyPacket</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\x1c'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#CurrentMicEBin"><span class="hs-identifier hs-var">CurrentMicEBin</span></a></span><span>
</span><span id="line-91"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'!'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#PositionNoTSNoMsg"><span class="hs-identifier hs-var">PositionNoTSNoMsg</span></a></span><span>
</span><span id="line-92"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">')'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#Item"><span class="hs-identifier hs-var">Item</span></a></span><span>
</span><span id="line-93"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#PositionNoMsg"><span class="hs-identifier hs-var">PositionNoMsg</span></a></span><span>
</span><span id="line-94"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#MessagePkt"><span class="hs-identifier hs-var">MessagePkt</span></a></span><span>
</span><span id="line-95"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">';'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#Object"><span class="hs-identifier hs-var">Object</span></a></span><span>
</span><span id="line-96"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&lt;'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#StationCaps"><span class="hs-identifier hs-var">StationCaps</span></a></span><span>
</span><span id="line-97"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#PositionNoTS"><span class="hs-identifier hs-var">PositionNoTS</span></a></span><span>
</span><span id="line-98"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'$'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#RawGPSOrUlt"><span class="hs-identifier hs-var">RawGPSOrUlt</span></a></span><span>
</span><span id="line-99"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&gt;'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#Status"><span class="hs-identifier hs-var">Status</span></a></span><span>
</span><span id="line-100"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'?'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#Query"><span class="hs-identifier hs-var">Query</span></a></span><span>
</span><span id="line-101"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'@'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#PositionMsg"><span class="hs-identifier hs-var">PositionMsg</span></a></span><span>
</span><span id="line-102"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'T'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#Telemetry"><span class="hs-identifier hs-var">Telemetry</span></a></span><span>
</span><span id="line-103"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#WeatherNoPos"><span class="hs-identifier hs-var">WeatherNoPos</span></a></span><span>
</span><span id="line-104"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'`'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#CurrentMicE"><span class="hs-identifier hs-var">CurrentMicE</span></a></span><span>
</span><span id="line-105"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'{'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#UserDefined"><span class="hs-identifier hs-var">UserDefined</span></a></span><span>
</span><span id="line-106"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'}'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PacketType
</span><a href="APRS.Types.html#ThirdParty"><span class="hs-identifier hs-var">ThirdParty</span></a></span><span>
</span><span id="line-107"></span><span class="annot"><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span id="local-6989586621679078224"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078224"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; PacketType
</span><a href="APRS.Types.html#InvalidPacket"><span class="hs-identifier hs-var">InvalidPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078224"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- Address Callsign SSID</span><span>
</span><span id="line-110"></span><span class="hs-keyword">data</span><span> </span><span id="Address"><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-var">Address</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Address"><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-var">Address</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078219"><span id="local-6989586621679078221"><span class="annot"><span class="annottext">Address -&gt; Address -&gt; Bool
(Address -&gt; Address -&gt; Bool)
-&gt; (Address -&gt; Address -&gt; Bool) -&gt; Eq Address
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Address -&gt; Address -&gt; Bool
$c/= :: Address -&gt; Address -&gt; Bool
== :: Address -&gt; Address -&gt; Bool
$c== :: Address -&gt; Address -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="annot"><a href="APRS.Types.html#addrChars"><span class="hs-identifier hs-type">addrChars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span id="addrChars"><span class="annot"><span class="annottext">addrChars :: String
</span><a href="APRS.Types.html#addrChars"><span class="hs-identifier hs-var hs-var">addrChars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'A'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'Z'</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'9'</span></span><span class="hs-special">]</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><a href="APRS.Types.html#address"><span class="hs-identifier hs-type">address</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span>
</span><span id="line-116"></span><span id="address"><span class="annot"><span class="annottext">address :: Text -&gt; Text -&gt; Either String Address
</span><a href="APRS.Types.html#address"><span class="hs-identifier hs-var hs-var">address</span></a></span></span><span> </span><span id="local-6989586621679078217"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078217"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679078216"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078216"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">Data.Text.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078217"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Address
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;callsign is too short&quot;</span></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">Data.Text.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078217"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Address
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;callsign is too long&quot;</span></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">Data.Text.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078216"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Address
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SSID is too long&quot;</span></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><a href="#local-6989586621679078213"><span class="hs-identifier hs-var">invalid</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078217"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Address
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;invalid characters in callsign&quot;</span></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><a href="#local-6989586621679078213"><span class="hs-identifier hs-var">invalid</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078216"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String Address
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;invalid characters in SSID&quot;</span></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Address -&gt; Either String Address
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Address -&gt; Either String Address)
-&gt; Address -&gt; Either String Address
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Address
</span><a href="APRS.Types.html#Address"><span class="hs-identifier hs-var">Address</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078217"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078216"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="#local-6989586621679078213"><span class="hs-identifier hs-type">invalid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-124"></span><span>        </span><span id="local-6989586621679078213"><span class="annot"><span class="annottext">invalid :: Text -&gt; Bool
</span><a href="#local-6989586621679078213"><span class="hs-identifier hs-var hs-var">invalid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Bool
</span><span class="hs-identifier hs-var">Data.Text.any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="APRS.Types.html#addrChars"><span class="hs-identifier hs-var">addrChars</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="annot"><a href="APRS.Types.html#unAddress"><span class="hs-identifier hs-type">unAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span id="unAddress"><span class="annot"><span class="annottext">unAddress :: Address -&gt; (Text, Text)
</span><a href="APRS.Types.html#unAddress"><span class="hs-identifier hs-var hs-var">unAddress</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span id="local-6989586621679078211"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078211"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679078210"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078210"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078211"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078210"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679078205"><span id="local-6989586621679078208"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>  </span><span id="local-6989586621679078204"><span class="annot"><span class="annottext">show :: Address -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span id="local-6989586621679078202"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078202"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078202"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span id="local-6989586621679078201"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078201"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679078200"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078200"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078201"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078200"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><a href="APRS.Types.html#parseAddr"><span class="hs-identifier hs-type">parseAddr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span>
</span><span id="line-134"></span><span id="parseAddr"><span class="annot"><span class="annottext">parseAddr :: Parser Address
</span><a href="APRS.Types.html#parseAddr"><span class="hs-identifier hs-var hs-var">parseAddr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621679078199"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078199"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text
</span><span class="hs-identifier hs-var">A.takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Char -&gt; Bool
</span><span class="hs-identifier hs-var">A.inClass</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;A-Z0-9&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>  </span><span id="local-6989586621679078196"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078196"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;-&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text
</span><span class="hs-identifier hs-var">A.takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Char -&gt; Bool
</span><span class="hs-identifier hs-var">A.inClass</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;A-Z0-9&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Parser Address)
-&gt; (Address -&gt; Parser Address)
-&gt; Either String Address
-&gt; Parser Address
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser Address
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">Address -&gt; Parser Address
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either String Address -&gt; Parser Address)
-&gt; Either String Address -&gt; Parser Address
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Either String Address
</span><a href="APRS.Types.html#address"><span class="hs-identifier hs-var">address</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078199"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078196"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679078188"><span id="local-6989586621679078190"><span id="local-6989586621679078192"><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>  </span><span id="local-6989586621679078186"><span class="annot"><span class="annottext">readsPrec :: Int -&gt; ReadS Address
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">readsPrec</span></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679078184"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078184"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadS Address
-&gt; (Address -&gt; [(Address, String)])
-&gt; Either String Address
-&gt; [(Address, String)]
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="annot"><span class="annottext">ReadS Address
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679078182"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679078182"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679078182"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Either String Address -&gt; [(Address, String)])
-&gt; Either String Address -&gt; [(Address, String)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parser Address -&gt; Text -&gt; Either String Address
forall a. Parser a -&gt; Text -&gt; Either String a
</span><span class="hs-identifier hs-var">A.parseOnly</span></span><span> </span><span class="annot"><span class="annottext">Parser Address
</span><a href="APRS.Types.html#parseAddr"><span class="hs-identifier hs-var">parseAddr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
forall a. IsString a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078184"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="annot"><a href="APRS.Types.html#ctoi"><span class="hs-identifier hs-type">ctoi</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span>
</span><span id="line-143"></span><span id="ctoi"><span class="annot"><span class="annottext">ctoi :: Char -&gt; Int16
</span><a href="APRS.Types.html#ctoi"><span class="hs-identifier hs-var hs-var">ctoi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int16
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int16) -&gt; (Char -&gt; Int) -&gt; Char -&gt; Int16
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="annot"><a href="APRS.Types.html#callPass"><span class="hs-identifier hs-type">callPass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int16</span></span><span>
</span><span id="line-146"></span><span id="callPass"><span class="annot"><span class="annottext">callPass :: Address -&gt; Int16
</span><a href="APRS.Types.html#callPass"><span class="hs-identifier hs-var hs-var">callPass</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span id="local-6989586621679078176"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078176"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">0x7fff</span></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Int16
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">(Int16 -&gt; Int16 -&gt; Int16) -&gt; Int16 -&gt; [Int16] -&gt; Int16
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16 -&gt; Int16
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">xor</span></span><span> </span><span class="annot"><span class="annottext">Int16
</span><span class="hs-number">0x73e2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Char, Int16 -&gt; Int16) -&gt; Int16)
-&gt; [(Char, Int16 -&gt; Int16)] -&gt; [Int16]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679078175"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078175"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679078174"><span class="annot"><span class="annottext">Int16 -&gt; Int16
</span><a href="#local-6989586621679078174"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16
</span><a href="#local-6989586621679078174"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int16
</span><a href="APRS.Types.html#ctoi"><span class="hs-identifier hs-var">ctoi</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078175"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Char, Int16 -&gt; Int16)] -&gt; [Int16])
-&gt; [(Char, Int16 -&gt; Int16)] -&gt; [Int16]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Int16 -&gt; Int16] -&gt; [(Char, Int16 -&gt; Int16)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078173"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">([Int16 -&gt; Int16] -&gt; [(Char, Int16 -&gt; Int16)])
-&gt; [Int16 -&gt; Int16] -&gt; [(Char, Int16 -&gt; Int16)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Int16 -&gt; Int16] -&gt; [Int16 -&gt; Int16]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">(Int16 -&gt; Int -&gt; Int16) -&gt; Int -&gt; Int16 -&gt; Int16
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int -&gt; Int16
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">shiftL</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int16 -&gt; Int16
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679078173"><span class="annot"><span class="annottext">a' :: String
</span><a href="#local-6989586621679078173"><span class="hs-identifier hs-var hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">unpack</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078176"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="APRS.Types.html#Similar"><span class="hs-identifier hs-type">Similar</span></a></span><span> </span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679078167"><span class="annot"><span class="annottext">&#8776; :: Address -&gt; Address -&gt; Bool
</span><a href="#local-6989586621679078167"><span class="hs-operator hs-var hs-var hs-var hs-var">(&#8776;)</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span id="local-6989586621679078166"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078166"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span id="local-6989586621679078165"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078165"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078166"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679078165"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="annot"><a href="APRS.Types.html#b91chars"><span class="hs-identifier hs-type">b91chars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-154"></span><span id="b91chars"><span class="annot"><span class="annottext">b91chars :: String
</span><a href="APRS.Types.html#b91chars"><span class="hs-identifier hs-var hs-var">b91chars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[!\&quot;#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ\\^_`abcdefghijklmnopqrstuvwxyz{]&quot;</span></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><a href="APRS.Types.html#parseB91Seg"><span class="hs-identifier hs-type">parseB91Seg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-157"></span><span id="parseB91Seg"><span class="annot"><span class="annottext">parseB91Seg :: Int -&gt; Parser Double
</span><a href="APRS.Types.html#parseB91Seg"><span class="hs-identifier hs-var hs-var">parseB91Seg</span></a></span></span><span> </span><span id="local-6989586621679078162"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078162"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; (String -&gt; Int) -&gt; String -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">String -&gt; Int
</span><a href="APRS.Types.html#decodeBase91"><span class="hs-identifier hs-var">decodeBase91</span></a></span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; ShowS -&gt; String -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">ShowS
forall a. IsString a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Double) -&gt; Parser Text String -&gt; Parser Double
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078162"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="APRS.Types.html#b91chars"><span class="hs-identifier hs-var">b91chars</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="annot"><a href="APRS.Types.html#posamb"><span class="hs-identifier hs-type">posamb</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-160"></span><span id="posamb"><span class="annot"><span class="annottext">posamb :: Int -&gt; Double
</span><a href="APRS.Types.html#posamb"><span class="hs-identifier hs-var hs-var">posamb</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-161"></span><span class="annot"><a href="APRS.Types.html#posamb"><span class="hs-identifier hs-var">posamb</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.05</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">60</span></span><span>
</span><span id="line-162"></span><span class="annot"><a href="APRS.Types.html#posamb"><span class="hs-identifier hs-var">posamb</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">60</span></span><span>
</span><span id="line-163"></span><span class="annot"><a href="APRS.Types.html#posamb"><span class="hs-identifier hs-var">posamb</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">60</span></span><span>
</span><span id="line-164"></span><span class="annot"><a href="APRS.Types.html#posamb"><span class="hs-identifier hs-var">posamb</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span>
</span><span id="line-165"></span><span class="annot"><a href="APRS.Types.html#posamb"><span class="hs-identifier hs-var">posamb</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Double
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid ambiguity&quot;</span></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="annot"><a href="APRS.Types.html#position"><span class="hs-identifier hs-type">position</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="APRS.Types.html#Frame"><span class="hs-identifier hs-type">Frame</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span>
</span><span id="line-168"></span><span id="position"><span class="annot"><span class="annottext">position :: Frame -&gt; Maybe Position
</span><a href="APRS.Types.html#position"><span class="hs-identifier hs-var hs-var">position</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Frame"><span class="hs-identifier hs-type">Frame</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#PositionPacket"><span class="hs-identifier hs-type">PositionPacket</span></a></span><span> </span><span class="annot"><span class="annottext">PacketType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679078154"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679078154"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Maybe Position
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679078154"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-169"></span><span class="annot"><a href="APRS.Types.html#position"><span class="hs-identifier hs-var">position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Frame"><span class="hs-identifier hs-type">Frame</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#ObjectPacket"><span class="hs-identifier hs-type">ObjectPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ObjectState
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679078152"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679078152"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="annot"><span class="annottext">Timestamp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ObjectData
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Maybe Position
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679078152"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-170"></span><span class="annot"><a href="APRS.Types.html#position"><span class="hs-identifier hs-var">position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Frame"><span class="hs-identifier hs-type">Frame</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#ItemPacket"><span class="hs-identifier hs-type">ItemPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ObjectState
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679078150"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679078150"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Maybe Position
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679078150"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-171"></span><span class="annot"><a href="APRS.Types.html#position"><span class="hs-identifier hs-var">position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Frame"><span class="hs-identifier hs-type">Frame</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#WeatherPacket"><span class="hs-identifier hs-type">WeatherPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679078148"><span class="annot"><span class="annottext">Maybe Position
</span><a href="#local-6989586621679078148"><span class="hs-identifier hs-var">mpos</span></a></span></span><span> </span><span class="annot"><span class="annottext">[WeatherParam]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">WeatherSW
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">WeatherUnit
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Position
</span><a href="#local-6989586621679078148"><span class="hs-identifier hs-var">mpos</span></a></span><span>
</span><span id="line-172"></span><span class="annot"><a href="APRS.Types.html#position"><span class="hs-identifier hs-var">position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Frame"><span class="hs-identifier hs-type">Frame</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#MicEPacket"><span class="hs-identifier hs-type">MicEPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679078146"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679078146"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Maybe Position
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679078146"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-173"></span><span class="annot"><a href="APRS.Types.html#position"><span class="hs-identifier hs-var">position</span></a></span><span> </span><span class="annot"><span class="annottext">Frame
</span><span class="hs-identifier">_</span></span><span>                                            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Position
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-keyword">data</span><span> </span><span id="Timestamp"><span class="annot"><a href="APRS.Types.html#Timestamp"><span class="hs-identifier hs-var">Timestamp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DHMLocal"><span class="annot"><a href="APRS.Types.html#DHMLocal"><span class="hs-identifier hs-var">DHMLocal</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="DHMZulu"><span class="annot"><a href="APRS.Types.html#DHMZulu"><span class="hs-identifier hs-var">DHMZulu</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="HMS"><span class="annot"><a href="APRS.Types.html#HMS"><span class="hs-identifier hs-var">HMS</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="MDHM"><span class="annot"><a href="APRS.Types.html#MDHM"><span class="hs-identifier hs-var">MDHM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078136"><span id="local-6989586621679078138"><span id="local-6989586621679078140"><span class="annot"><span class="annottext">Int -&gt; Timestamp -&gt; ShowS
[Timestamp] -&gt; ShowS
Timestamp -&gt; String
(Int -&gt; Timestamp -&gt; ShowS)
-&gt; (Timestamp -&gt; String)
-&gt; ([Timestamp] -&gt; ShowS)
-&gt; Show Timestamp
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Timestamp] -&gt; ShowS
$cshowList :: [Timestamp] -&gt; ShowS
show :: Timestamp -&gt; String
$cshow :: Timestamp -&gt; String
showsPrec :: Int -&gt; Timestamp -&gt; ShowS
$cshowsPrec :: Int -&gt; Timestamp -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679078132"><span id="local-6989586621679078134"><span class="annot"><span class="annottext">Timestamp -&gt; Timestamp -&gt; Bool
(Timestamp -&gt; Timestamp -&gt; Bool)
-&gt; (Timestamp -&gt; Timestamp -&gt; Bool) -&gt; Eq Timestamp
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Timestamp -&gt; Timestamp -&gt; Bool
$c/= :: Timestamp -&gt; Timestamp -&gt; Bool
== :: Timestamp -&gt; Timestamp -&gt; Bool
$c== :: Timestamp -&gt; Timestamp -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="annot"><a href="APRS.Types.html#parseTimestamp"><span class="hs-identifier hs-type">parseTimestamp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span>
</span><span id="line-182"></span><span id="parseTimestamp"><span class="annot"><span class="annottext">parseTimestamp :: Parser Timestamp
</span><a href="APRS.Types.html#parseTimestamp"><span class="hs-identifier hs-var hs-var">parseTimestamp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Timestamp
</span><a href="#local-6989586621679078131"><span class="hs-identifier hs-var">dhmlocal</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Timestamp -&gt; Parser Timestamp -&gt; Parser Timestamp
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Timestamp
</span><a href="#local-6989586621679078130"><span class="hs-identifier hs-var">dhmzulu</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Timestamp -&gt; Parser Timestamp -&gt; Parser Timestamp
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Timestamp
</span><a href="#local-6989586621679078129"><span class="hs-identifier hs-var">hms</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Timestamp -&gt; Parser Timestamp -&gt; Parser Timestamp
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Timestamp
</span><a href="#local-6989586621679078128"><span class="hs-identifier hs-var">mdhm</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621679078131"><span class="annot"><span class="annottext">dhmlocal :: Parser Timestamp
</span><a href="#local-6989586621679078131"><span class="hs-identifier hs-var hs-var">dhmlocal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int, Int) -&gt; Timestamp
</span><a href="APRS.Types.html#DHMLocal"><span class="hs-identifier hs-var">DHMLocal</span></a></span><span> </span><span class="annot"><span class="annottext">((Int, Int, Int) -&gt; Timestamp)
-&gt; Parser Text (Int, Int, Int) -&gt; Parser Timestamp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Text (Int, Int, Int)
</span><a href="#local-6989586621679078127"><span class="hs-identifier hs-var">n3</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span>
</span><span id="line-185"></span><span>    </span><span id="local-6989586621679078130"><span class="annot"><span class="annottext">dhmzulu :: Parser Timestamp
</span><a href="#local-6989586621679078130"><span class="hs-identifier hs-var hs-var">dhmzulu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int, Int) -&gt; Timestamp
</span><a href="APRS.Types.html#DHMZulu"><span class="hs-identifier hs-var">DHMZulu</span></a></span><span> </span><span class="annot"><span class="annottext">((Int, Int, Int) -&gt; Timestamp)
-&gt; Parser Text (Int, Int, Int) -&gt; Parser Timestamp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Text (Int, Int, Int)
</span><a href="#local-6989586621679078127"><span class="hs-identifier hs-var">n3</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'z'</span></span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621679078129"><span class="annot"><span class="annottext">hms :: Parser Timestamp
</span><a href="#local-6989586621679078129"><span class="hs-identifier hs-var hs-var">hms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int, Int) -&gt; Timestamp
</span><a href="APRS.Types.html#HMS"><span class="hs-identifier hs-var">HMS</span></a></span><span> </span><span class="annot"><span class="annottext">((Int, Int, Int) -&gt; Timestamp)
-&gt; Parser Text (Int, Int, Int) -&gt; Parser Timestamp
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Text (Int, Int, Int)
</span><a href="#local-6989586621679078127"><span class="hs-identifier hs-var">n3</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'h'</span></span><span>
</span><span id="line-187"></span><span>    </span><span id="local-6989586621679078128"><span class="annot"><span class="annottext">mdhm :: Parser Timestamp
</span><a href="#local-6989586621679078128"><span class="hs-identifier hs-var hs-var">mdhm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser [Int]
</span><a href="#local-6989586621679078126"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Parser [Int] -&gt; ([Int] -&gt; Parser Timestamp) -&gt; Parser Timestamp
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">[</span><span id="local-6989586621679078125"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078125"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679078124"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078124"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679078123"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078123"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679078122"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078122"><span class="hs-identifier hs-var">mn</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Timestamp -&gt; Parser Timestamp
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Timestamp -&gt; Parser Timestamp) -&gt; Timestamp -&gt; Parser Timestamp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int, Int, Int) -&gt; Timestamp
</span><a href="APRS.Types.html#MDHM"><span class="hs-identifier hs-var">MDHM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078125"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078124"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078123"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078122"><span class="hs-identifier hs-var">mn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><a href="#local-6989586621679078126"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621679078126"><span class="annot"><span class="annottext">n :: Int -&gt; Parser [Int]
</span><a href="#local-6989586621679078126"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679078121"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078121"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Text String -&gt; Parser Text [String]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078121"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.digit</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Text [String] -&gt; ([String] -&gt; Parser [Int]) -&gt; Parser [Int]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679078119"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679078119"><span class="hs-identifier hs-var">digs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Parser [Int]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; Parser [Int]) -&gt; [Int] -&gt; Parser [Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; [String] -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679078119"><span class="hs-identifier hs-var">digs</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="#local-6989586621679078127"><span class="hs-identifier hs-type">n3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621679078127"><span class="annot"><span class="annottext">n3 :: Char -&gt; Parser Text (Int, Int, Int)
</span><a href="#local-6989586621679078127"><span class="hs-identifier hs-var hs-var">n3</span></a></span></span><span> </span><span id="local-6989586621679078117"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078117"><span class="hs-identifier hs-var">ch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser [Int]
</span><a href="#local-6989586621679078126"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Parser [Int]
-&gt; ([Int] -&gt; Parser Text (Int, Int, Int))
-&gt; Parser Text (Int, Int, Int)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">[</span><span id="local-6989586621679078116"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078116"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078115"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078115"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679078114"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078114"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078117"><span class="hs-identifier hs-var">ch</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
-&gt; Parser Text (Int, Int, Int) -&gt; Parser Text (Int, Int, Int)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int, Int) -&gt; Parser Text (Int, Int, Int)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078116"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078115"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078114"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- data Position = Position { _pos :: Geodetic WGS84, _ambiguity :: Int }</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- lon, lat, alt, extension</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- TODO: Perhaps stuff some extensions in here to cover PosExtension</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- as well as compression type and ambiguity.</span><span>
</span><span id="line-198"></span><span class="hs-keyword">newtype</span><span> </span><span id="Position"><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-var">Position</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Position"><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-var">Position</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#PosExtension"><span class="hs-identifier hs-type">PosExtension</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078108"><span id="local-6989586621679078110"><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Bool
(Position -&gt; Position -&gt; Bool)
-&gt; (Position -&gt; Position -&gt; Bool) -&gt; Eq Position
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Position -&gt; Position -&gt; Bool
$c/= :: Position -&gt; Position -&gt; Bool
== :: Position -&gt; Position -&gt; Bool
$c== :: Position -&gt; Position -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679078102"><span id="local-6989586621679078104"><span id="local-6989586621679078106"><span class="annot"><span class="annottext">Int -&gt; Position -&gt; ShowS
[Position] -&gt; ShowS
Position -&gt; String
(Int -&gt; Position -&gt; ShowS)
-&gt; (Position -&gt; String) -&gt; ([Position] -&gt; ShowS) -&gt; Show Position
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Position] -&gt; ShowS
$cshowList :: [Position] -&gt; ShowS
show :: Position -&gt; String
$cshow :: Position -&gt; String
showsPrec :: Int -&gt; Position -&gt; ShowS
$cshowsPrec :: Int -&gt; Position -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><a href="APRS.Types.html#distance"><span class="hs-identifier hs-type">distance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-201"></span><span id="distance"><span class="annot"><span class="annottext">distance :: Position -&gt; Position -&gt; Double
</span><a href="APRS.Types.html#distance"><span class="hs-identifier hs-var hs-var">distance</span></a></span></span><span> </span><span id="local-6989586621679078101"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679078101"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679078100"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679078100"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Geodetic WGS84
-&gt; Geodetic WGS84
-&gt; Maybe
     (Length Double, Dimensionless Double, Dimensionless Double)
forall e.
Ellipsoid e =&gt;
Geodetic e
-&gt; Geodetic e
-&gt; Maybe
     (Length Double, Dimensionless Double, Dimensionless Double)
</span><span class="hs-identifier hs-var">groundDistance</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; Geodetic WGS84
</span><a href="#local-6989586621679078099"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679078101"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; Geodetic WGS84
</span><a href="#local-6989586621679078099"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679078100"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-202"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078098"><span class="annot"><span class="annottext">Length Double
</span><a href="#local-6989586621679078098"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dimensionless Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Dimensionless Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679078097"><span class="annot"><span class="annottext">d' :: Double
</span><a href="#local-6989586621679078097"><span class="hs-identifier hs-var hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Length Double
</span><a href="#local-6989586621679078098"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Length Double -&gt; Unit 'Metric DLength Double -&gt; Double
forall a (d :: Dimension) (m :: Metricality).
Fractional a =&gt;
Quantity d a -&gt; Unit m d a -&gt; a
</span><span class="hs-operator hs-var">/~</span></span><span> </span><span class="annot"><span class="annottext">Unit 'Metric DLength Double
forall a. Num a =&gt; Unit 'Metric DLength a
</span><span class="hs-identifier hs-var">meter</span></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool
forall a. RealFloat a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">isNaN</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679078097"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679078097"><span class="hs-identifier hs-var">d'</span></a></span><span>
</span><span id="line-203"></span><span>                 </span><span class="annot"><span class="annottext">Maybe (Length Double, Dimensionless Double, Dimensionless Double)
</span><span class="hs-identifier">_</span></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679078099"><span class="annot"><span class="annottext">g :: Position -&gt; Geodetic WGS84
</span><a href="#local-6989586621679078099"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078095"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679078095"><span class="hs-identifier hs-var">lon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679078094"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679078094"><span class="hs-identifier hs-var">lat</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PosExtension
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimensionless Double
-&gt; Dimensionless Double -&gt; Length Double -&gt; WGS84 -&gt; Geodetic WGS84
forall e.
Dimensionless Double
-&gt; Dimensionless Double -&gt; Length Double -&gt; e -&gt; Geodetic e
</span><span class="hs-identifier hs-var">Geodetic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679078094"><span class="hs-identifier hs-var">lat</span></a></span><span> </span><span class="annot"><span class="annottext">Double
-&gt; Unit 'NonMetric DPlaneAngle Double -&gt; Dimensionless Double
forall a (m :: Metricality) (d :: Dimension).
Num a =&gt;
a -&gt; Unit m d a -&gt; Quantity d a
</span><span class="hs-operator hs-var">*~</span></span><span> </span><span class="annot"><span class="annottext">Unit 'NonMetric DPlaneAngle Double
forall a. Floating a =&gt; Unit 'NonMetric DPlaneAngle a
</span><span class="hs-identifier hs-var">degree</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679078095"><span class="hs-identifier hs-var">lon</span></a></span><span> </span><span class="annot"><span class="annottext">Double
-&gt; Unit 'NonMetric DPlaneAngle Double -&gt; Dimensionless Double
forall a (m :: Metricality) (d :: Dimension).
Num a =&gt;
a -&gt; Unit m d a -&gt; Quantity d a
</span><span class="hs-operator hs-var">*~</span></span><span> </span><span class="annot"><span class="annottext">Unit 'NonMetric DPlaneAngle Double
forall a. Floating a =&gt; Unit 'NonMetric DPlaneAngle a
</span><span class="hs-identifier hs-var">degree</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Length Double
forall a (d :: Dimension). Num a =&gt; Quantity d a
</span><span class="hs-identifier hs-var">_0</span></span><span> </span><span class="annot"><span class="annottext">WGS84
</span><span class="hs-identifier hs-var">WGS84</span></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-keyword">data</span><span> </span><span id="WeatherParam"><span class="annot"><a href="APRS.Types.html#WeatherParam"><span class="hs-identifier hs-var">WeatherParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="WindDir"><span class="annot"><a href="APRS.Types.html#WindDir"><span class="hs-identifier hs-var">WindDir</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-208"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="WindSpeed"><span class="annot"><a href="APRS.Types.html#WindSpeed"><span class="hs-identifier hs-var">WindSpeed</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-209"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="WindGust"><span class="annot"><a href="APRS.Types.html#WindGust"><span class="hs-identifier hs-var">WindGust</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-210"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="Temp"><span class="annot"><a href="APRS.Types.html#Temp"><span class="hs-identifier hs-var">Temp</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-211"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="RainLastHour"><span class="annot"><a href="APRS.Types.html#RainLastHour"><span class="hs-identifier hs-var">RainLastHour</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-212"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="RainLast24Hours"><span class="annot"><a href="APRS.Types.html#RainLast24Hours"><span class="hs-identifier hs-var">RainLast24Hours</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-213"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="RainToday"><span class="annot"><a href="APRS.Types.html#RainToday"><span class="hs-identifier hs-var">RainToday</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-214"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="Humidity"><span class="annot"><a href="APRS.Types.html#Humidity"><span class="hs-identifier hs-var">Humidity</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-215"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="Baro"><span class="annot"><a href="APRS.Types.html#Baro"><span class="hs-identifier hs-var">Baro</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-216"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="Voltage"><span class="annot"><a href="APRS.Types.html#Voltage"><span class="hs-identifier hs-var">Voltage</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-217"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="WaterLevel"><span class="annot"><a href="APRS.Types.html#WaterLevel"><span class="hs-identifier hs-var">WaterLevel</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-218"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="Luminosity"><span class="annot"><a href="APRS.Types.html#Luminosity"><span class="hs-identifier hs-var">Luminosity</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-219"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="Snowfall"><span class="annot"><a href="APRS.Types.html#Snowfall"><span class="hs-identifier hs-var">Snowfall</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-220"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="RawRain"><span class="annot"><a href="APRS.Types.html#RawRain"><span class="hs-identifier hs-var">RawRain</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-221"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="NoData"><span class="annot"><a href="APRS.Types.html#NoData"><span class="hs-identifier hs-var">NoData</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-222"></span><span>                  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078071"><span id="local-6989586621679078073"><span id="local-6989586621679078075"><span class="annot"><span class="annottext">Int -&gt; WeatherParam -&gt; ShowS
[WeatherParam] -&gt; ShowS
WeatherParam -&gt; String
(Int -&gt; WeatherParam -&gt; ShowS)
-&gt; (WeatherParam -&gt; String)
-&gt; ([WeatherParam] -&gt; ShowS)
-&gt; Show WeatherParam
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [WeatherParam] -&gt; ShowS
$cshowList :: [WeatherParam] -&gt; ShowS
show :: WeatherParam -&gt; String
$cshow :: WeatherParam -&gt; String
showsPrec :: Int -&gt; WeatherParam -&gt; ShowS
$cshowsPrec :: Int -&gt; WeatherParam -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679078067"><span id="local-6989586621679078069"><span class="annot"><span class="annottext">WeatherParam -&gt; WeatherParam -&gt; Bool
(WeatherParam -&gt; WeatherParam -&gt; Bool)
-&gt; (WeatherParam -&gt; WeatherParam -&gt; Bool) -&gt; Eq WeatherParam
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: WeatherParam -&gt; WeatherParam -&gt; Bool
$c/= :: WeatherParam -&gt; WeatherParam -&gt; Bool
== :: WeatherParam -&gt; WeatherParam -&gt; Bool
$c== :: WeatherParam -&gt; WeatherParam -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="annot"><a href="APRS.Types.html#parseWParam"><span class="hs-identifier hs-type">parseWParam</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#WeatherParam"><span class="hs-identifier hs-type">WeatherParam</span></a></span><span>
</span><span id="line-225"></span><span id="parseWParam"><span class="annot"><span class="annottext">parseWParam :: Parser WeatherParam
</span><a href="APRS.Types.html#parseWParam"><span class="hs-identifier hs-var hs-var">parseWParam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078065"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'c'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#WindDir"><span class="hs-identifier hs-var">WindDir</span></a></span><span>
</span><span id="line-226"></span><span>              </span><span class="annot"><span class="annottext">Parser WeatherParam -&gt; Parser WeatherParam -&gt; Parser WeatherParam
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078065"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'s'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#WindSpeed"><span class="hs-identifier hs-var">WindSpeed</span></a></span><span>
</span><span id="line-227"></span><span>              </span><span class="annot"><span class="annottext">Parser WeatherParam -&gt; Parser WeatherParam -&gt; Parser WeatherParam
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078065"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'g'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#WindGust"><span class="hs-identifier hs-var">WindGust</span></a></span><span>
</span><span id="line-228"></span><span>              </span><span class="annot"><span class="annottext">Parser WeatherParam -&gt; Parser WeatherParam -&gt; Parser WeatherParam
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078065"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'t'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; WeatherParam
</span><a href="APRS.Types.html#Temp"><span class="hs-identifier hs-var">Temp</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; WeatherParam) -&gt; (Int -&gt; Double) -&gt; Int -&gt; WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="APRS.Types.html#f2c"><span class="hs-identifier hs-var">f2c</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; (Int -&gt; Double) -&gt; Int -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>              </span><span class="annot"><span class="annottext">Parser WeatherParam -&gt; Parser WeatherParam -&gt; Parser WeatherParam
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078065"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'r'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#RainLastHour"><span class="hs-identifier hs-var">RainLastHour</span></a></span><span>
</span><span id="line-230"></span><span>              </span><span class="annot"><span class="annottext">Parser WeatherParam -&gt; Parser WeatherParam -&gt; Parser WeatherParam
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078065"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'p'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#RainLast24Hours"><span class="hs-identifier hs-var">RainLast24Hours</span></a></span><span>
</span><span id="line-231"></span><span>              </span><span class="annot"><span class="annottext">Parser WeatherParam -&gt; Parser WeatherParam -&gt; Parser WeatherParam
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078065"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'P'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#RainToday"><span class="hs-identifier hs-var">RainToday</span></a></span><span>
</span><span id="line-232"></span><span>              </span><span class="annot"><span class="annottext">Parser WeatherParam -&gt; Parser WeatherParam -&gt; Parser WeatherParam
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078065"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'F'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; WeatherParam
</span><a href="APRS.Types.html#WaterLevel"><span class="hs-identifier hs-var">WaterLevel</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; WeatherParam) -&gt; (Int -&gt; Double) -&gt; Int -&gt; WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; (Int -&gt; Double) -&gt; Int -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>              </span><span class="annot"><span class="annottext">Parser WeatherParam -&gt; Parser WeatherParam -&gt; Parser WeatherParam
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078065"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'V'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; WeatherParam
</span><a href="APRS.Types.html#Voltage"><span class="hs-identifier hs-var">Voltage</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; WeatherParam) -&gt; (Int -&gt; Double) -&gt; Int -&gt; WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; (Int -&gt; Double) -&gt; Int -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>              </span><span class="annot"><span class="annottext">Parser WeatherParam -&gt; Parser WeatherParam -&gt; Parser WeatherParam
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078063"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'h'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#Humidity"><span class="hs-identifier hs-var">Humidity</span></a></span><span>
</span><span id="line-235"></span><span>              </span><span class="annot"><span class="annottext">Parser WeatherParam -&gt; Parser WeatherParam -&gt; Parser WeatherParam
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078063"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'b'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#Baro"><span class="hs-identifier hs-var">Baro</span></a></span><span>
</span><span id="line-236"></span><span>              </span><span class="annot"><span class="annottext">Parser WeatherParam -&gt; Parser WeatherParam -&gt; Parser WeatherParam
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078065"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'L'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#Luminosity"><span class="hs-identifier hs-var">Luminosity</span></a></span><span>
</span><span id="line-237"></span><span>              </span><span class="annot"><span class="annottext">Parser WeatherParam -&gt; Parser WeatherParam -&gt; Parser WeatherParam
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078065"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'l'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#Luminosity"><span class="hs-identifier hs-var">Luminosity</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; WeatherParam) -&gt; (Int -&gt; Int) -&gt; Int -&gt; WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>              </span><span class="annot"><span class="annottext">Parser WeatherParam -&gt; Parser WeatherParam -&gt; Parser WeatherParam
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078065"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'#'</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#RawRain"><span class="hs-identifier hs-var">RawRain</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-240"></span><span>    </span><span class="annot"><a href="#local-6989586621679078063"><span class="hs-identifier hs-type">w'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="APRS.Types.html#WeatherParam"><span class="hs-identifier hs-type">WeatherParam</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#WeatherParam"><span class="hs-identifier hs-type">WeatherParam</span></a></span><span>
</span><span id="line-241"></span><span>    </span><span id="local-6989586621679078063"><span class="annot"><span class="annottext">w' :: Int -&gt; Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078063"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span id="local-6989586621679078061"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078061"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679078060"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078060"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679078059"><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="#local-6989586621679078059"><span class="hs-identifier hs-var">wc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-242"></span><span>      </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078060"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-243"></span><span>      </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
forall t b. Read t =&gt; Int -&gt; (t -&gt; b) -&gt; Parser Text b
</span><a href="#local-6989586621679078058"><span class="hs-identifier hs-var">wgood</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078061"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="#local-6989586621679078059"><span class="hs-identifier hs-var">wc</span></a></span><span> </span><span class="annot"><span class="annottext">Parser WeatherParam -&gt; Parser WeatherParam -&gt; Parser WeatherParam
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078057"><span class="hs-identifier hs-var">wnodata</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078061"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078060"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>    </span><span id="local-6989586621679078058"><span class="annot"><span class="annottext">wgood :: Int -&gt; (t -&gt; b) -&gt; Parser Text b
</span><a href="#local-6989586621679078058"><span class="hs-identifier hs-var hs-var">wgood</span></a></span></span><span> </span><span id="local-6989586621679078056"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078056"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679078055"><span class="annot"><span class="annottext">t -&gt; b
</span><a href="#local-6989586621679078055"><span class="hs-identifier hs-var">wc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078056"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.digit</span></span><span> </span><span class="annot"><span class="annottext">Parser Text String -&gt; (String -&gt; Parser Text b) -&gt; Parser Text b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679078054"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078054"><span class="hs-identifier hs-var">deez</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; Parser Text b
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(b -&gt; Parser Text b) -&gt; b -&gt; Parser Text b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; b
</span><a href="#local-6989586621679078055"><span class="hs-identifier hs-var">wc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; t
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078054"><span class="hs-identifier hs-var">deez</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>    </span><span id="local-6989586621679078057"><span class="annot"><span class="annottext">wnodata :: Int -&gt; Char -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078057"><span class="hs-identifier hs-var hs-var">wnodata</span></a></span></span><span> </span><span id="local-6989586621679078053"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078053"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679078052"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078052"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Text Char -&gt; Parser Text ()
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">replicateM_</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078053"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Text () -&gt; Parser WeatherParam -&gt; Parser WeatherParam
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">WeatherParam -&gt; Parser WeatherParam
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; WeatherParam
</span><a href="APRS.Types.html#NoData"><span class="hs-identifier hs-var">NoData</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078052"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621679078065"><span class="annot"><span class="annottext">w :: Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078065"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; (Int -&gt; WeatherParam) -&gt; Parser WeatherParam
</span><a href="#local-6989586621679078063"><span class="hs-identifier hs-var">w'</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="annot"><a href="APRS.Types.html#parseWeather"><span class="hs-identifier hs-type">parseWeather</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="APRS.Types.html#WeatherParam"><span class="hs-identifier hs-type">WeatherParam</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-251"></span><span id="parseWeather"><span class="annot"><span class="annottext">parseWeather :: Parser [WeatherParam]
</span><a href="APRS.Types.html#parseWeather"><span class="hs-identifier hs-var hs-var">parseWeather</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser WeatherParam -&gt; Parser [WeatherParam]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">A.many1</span></span><span> </span><span class="annot"><span class="annottext">Parser WeatherParam
</span><a href="APRS.Types.html#parseWParam"><span class="hs-identifier hs-var">parseWParam</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- Source Dest Path Body</span><span>
</span><span id="line-254"></span><span class="hs-keyword">data</span><span> </span><span id="Frame"><span class="annot"><a href="APRS.Types.html#Frame"><span class="hs-identifier hs-var">Frame</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Frame"><span class="annot"><a href="APRS.Types.html#Frame"><span class="hs-identifier hs-var">Frame</span></a></span></span><span> </span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-type">APRSPacket</span></a></span><span>
</span><span id="line-255"></span><span>           </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078045"><span id="local-6989586621679078047"><span id="local-6989586621679078049"><span class="annot"><span class="annottext">Int -&gt; Frame -&gt; ShowS
[Frame] -&gt; ShowS
Frame -&gt; String
(Int -&gt; Frame -&gt; ShowS)
-&gt; (Frame -&gt; String) -&gt; ([Frame] -&gt; ShowS) -&gt; Show Frame
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Frame] -&gt; ShowS
$cshowList :: [Frame] -&gt; ShowS
show :: Frame -&gt; String
$cshow :: Frame -&gt; String
showsPrec :: Int -&gt; Frame -&gt; ShowS
$cshowsPrec :: Int -&gt; Frame -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679078041"><span id="local-6989586621679078043"><span class="annot"><span class="annottext">Frame -&gt; Frame -&gt; Bool
(Frame -&gt; Frame -&gt; Bool) -&gt; (Frame -&gt; Frame -&gt; Bool) -&gt; Eq Frame
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Frame -&gt; Frame -&gt; Bool
$c/= :: Frame -&gt; Frame -&gt; Bool
== :: Frame -&gt; Frame -&gt; Bool
$c== :: Frame -&gt; Frame -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="annot"><a href="APRS.Types.html#parseFrame"><span class="hs-identifier hs-type">parseFrame</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Frame"><span class="hs-identifier hs-type">Frame</span></a></span><span>
</span><span id="line-258"></span><span id="parseFrame"><span class="annot"><span class="annottext">parseFrame :: Parser Frame
</span><a href="APRS.Types.html#parseFrame"><span class="hs-identifier hs-var hs-var">parseFrame</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621679078040"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679078040"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Address
</span><a href="APRS.Types.html#parseAddr"><span class="hs-identifier hs-var">parseAddr</span></a></span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&gt;'</span></span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679078039"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679078039"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Address
</span><a href="APRS.Types.html#parseAddr"><span class="hs-identifier hs-var">parseAddr</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><span class="hs-identifier hs-var">A.string</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-comment">-- maybe comma</span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621679078037"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679078037"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text Char -&gt; Parser Text [Text]
forall (f :: * -&gt; *) a s. Alternative f =&gt; f a -&gt; f s -&gt; f [a]
</span><span class="hs-identifier hs-var">A.sepBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text
</span><span class="hs-identifier hs-var">A.takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621679078035"><span class="annot"><span class="annottext">APRSPacket
</span><a href="#local-6989586621679078035"><span class="hs-identifier hs-var">bod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Address -&gt; Parser APRSPacket
</span><a href="APRS.Types.html#bodyParser"><span class="hs-identifier hs-var">bodyParser</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679078039"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span class="annot"><span class="annottext">Frame -&gt; Parser Frame
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Frame -&gt; Parser Frame) -&gt; Frame -&gt; Parser Frame
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Address -&gt; Address -&gt; [Text] -&gt; APRSPacket -&gt; Frame
</span><a href="APRS.Types.html#Frame"><span class="hs-identifier hs-var">Frame</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679078040"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679078039"><span class="hs-identifier hs-var">dest</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679078037"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">APRSPacket
</span><a href="#local-6989586621679078035"><span class="hs-identifier hs-var">bod</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="annot"><a href="APRS.Types.html#decodeBase91"><span class="hs-identifier hs-type">decodeBase91</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-269"></span><span id="decodeBase91"><span class="annot"><span class="annottext">decodeBase91 :: String -&gt; Int
</span><a href="APRS.Types.html#decodeBase91"><span class="hs-identifier hs-var hs-var">decodeBase91</span></a></span></span><span> </span><span id="local-6989586621679078034"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078034"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679078033"><span class="annot"><span class="annottext">l :: Int
</span><a href="#local-6989586621679078033"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">Prelude.length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078034"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><span class="annottext">(Int -&gt; (Char, Int) -&gt; Int) -&gt; Int -&gt; [(Char, Int)] -&gt; Int
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679078031"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078031"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078030"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078030"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679078029"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078029"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078029"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; (Char -&gt; Int) -&gt; Char -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Int) -&gt; Char -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679078030"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">33</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078031"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">([(Char, Int)] -&gt; Int) -&gt; [(Char, Int)] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Int] -&gt; [(Char, Int)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078034"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">91</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078026"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679078026"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078026"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078033"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Enum a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">pred</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679078033"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">{-
&#8226; Position
&#8226; Direction Finding
&#8226; Objects and Items
&#8226; Weather
&#8226; Telemetry
&#8226; Messages, Bulletins and Announcements
&#8226; Queries
&#8226; Responses
&#8226; Status
&#8226; Other
-}</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-keyword">data</span><span> </span><span id="PosExtension"><span class="annot"><a href="APRS.Types.html#PosExtension"><span class="hs-identifier hs-var">PosExtension</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PosECourseSpeed"><span class="annot"><a href="APRS.Types.html#PosECourseSpeed"><span class="hs-identifier hs-var">PosECourseSpeed</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-287"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="PosEPHG"><span class="annot"><a href="APRS.Types.html#PosEPHG"><span class="hs-identifier hs-var">PosEPHG</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Directivity"><span class="hs-identifier hs-type">Directivity</span></a></span><span>
</span><span id="line-288"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="PosERNG"><span class="annot"><a href="APRS.Types.html#PosERNG"><span class="hs-identifier hs-var">PosERNG</span></a></span></span><span> </span><span class="hs-comment">-- TODO</span><span>
</span><span id="line-289"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="PosEDFS"><span class="annot"><a href="APRS.Types.html#PosEDFS"><span class="hs-identifier hs-var">PosEDFS</span></a></span></span><span> </span><span class="hs-comment">-- TODO</span><span>
</span><span id="line-290"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="PosETypeDesc"><span class="annot"><a href="APRS.Types.html#PosETypeDesc"><span class="hs-identifier hs-var">PosETypeDesc</span></a></span></span><span> </span><span class="hs-comment">-- TODO</span><span>
</span><span id="line-291"></span><span>                  </span><span class="hs-glyph">|</span><span> </span><span id="PosENone"><span class="annot"><a href="APRS.Types.html#PosENone"><span class="hs-identifier hs-var">PosENone</span></a></span></span><span>
</span><span id="line-292"></span><span>                  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679078013"><span id="local-6989586621679078015"><span id="local-6989586621679078017"><span class="annot"><span class="annottext">Int -&gt; PosExtension -&gt; ShowS
[PosExtension] -&gt; ShowS
PosExtension -&gt; String
(Int -&gt; PosExtension -&gt; ShowS)
-&gt; (PosExtension -&gt; String)
-&gt; ([PosExtension] -&gt; ShowS)
-&gt; Show PosExtension
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PosExtension] -&gt; ShowS
$cshowList :: [PosExtension] -&gt; ShowS
show :: PosExtension -&gt; String
$cshow :: PosExtension -&gt; String
showsPrec :: Int -&gt; PosExtension -&gt; ShowS
$cshowsPrec :: Int -&gt; PosExtension -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679078009"><span id="local-6989586621679078011"><span class="annot"><span class="annottext">PosExtension -&gt; PosExtension -&gt; Bool
(PosExtension -&gt; PosExtension -&gt; Bool)
-&gt; (PosExtension -&gt; PosExtension -&gt; Bool) -&gt; Eq PosExtension
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PosExtension -&gt; PosExtension -&gt; Bool
$c/= :: PosExtension -&gt; PosExtension -&gt; Bool
== :: PosExtension -&gt; PosExtension -&gt; Bool
$c== :: PosExtension -&gt; PosExtension -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-comment">-- Parse common aaa/bbb to (a,b)</span><span>
</span><span id="line-295"></span><span class="annot"><a href="APRS.Types.html#parseCourseSpeed"><span class="hs-identifier hs-type">parseCourseSpeed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span id="parseCourseSpeed"><span class="annot"><span class="annottext">parseCourseSpeed :: Parser (Int, Double)
</span><a href="APRS.Types.html#parseCourseSpeed"><span class="hs-identifier hs-var hs-var">parseCourseSpeed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-297"></span><span>  </span><span id="local-6989586621679078007"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078007"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.digit</span></span><span>
</span><span id="line-298"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span>
</span><span id="line-299"></span><span>  </span><span id="local-6989586621679078006"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078006"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.digit</span></span><span>
</span><span id="line-300"></span><span>  </span><span class="annot"><span class="annottext">(Int, Double) -&gt; Parser (Int, Double)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078007"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">360</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Integer
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679078006"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.852</span></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-keyword">data</span><span> </span><span id="Directivity"><span class="annot"><a href="APRS.Types.html#Directivity"><span class="hs-identifier hs-var">Directivity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Omni"><span class="annot"><a href="APRS.Types.html#Omni"><span class="hs-identifier hs-var">Omni</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="DirNE"><span class="annot"><a href="APRS.Types.html#DirNE"><span class="hs-identifier hs-var">DirNE</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="DirE"><span class="annot"><a href="APRS.Types.html#DirE"><span class="hs-identifier hs-var">DirE</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="DirSE"><span class="annot"><a href="APRS.Types.html#DirSE"><span class="hs-identifier hs-var">DirSE</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="DirS"><span class="annot"><a href="APRS.Types.html#DirS"><span class="hs-identifier hs-var">DirS</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="DirSW"><span class="annot"><a href="APRS.Types.html#DirSW"><span class="hs-identifier hs-var">DirSW</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="DirW"><span class="annot"><a href="APRS.Types.html#DirW"><span class="hs-identifier hs-var">DirW</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="DirNW"><span class="annot"><a href="APRS.Types.html#DirNW"><span class="hs-identifier hs-var">DirNW</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="DirN"><span class="annot"><a href="APRS.Types.html#DirN"><span class="hs-identifier hs-var">DirN</span></a></span></span><span>
</span><span id="line-303"></span><span>                 </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077990"><span id="local-6989586621679077992"><span id="local-6989586621679077994"><span class="annot"><span class="annottext">Int -&gt; Directivity -&gt; ShowS
[Directivity] -&gt; ShowS
Directivity -&gt; String
(Int -&gt; Directivity -&gt; ShowS)
-&gt; (Directivity -&gt; String)
-&gt; ([Directivity] -&gt; ShowS)
-&gt; Show Directivity
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Directivity] -&gt; ShowS
$cshowList :: [Directivity] -&gt; ShowS
show :: Directivity -&gt; String
$cshow :: Directivity -&gt; String
showsPrec :: Int -&gt; Directivity -&gt; ShowS
$cshowsPrec :: Int -&gt; Directivity -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077986"><span id="local-6989586621679077988"><span class="annot"><span class="annottext">Directivity -&gt; Directivity -&gt; Bool
(Directivity -&gt; Directivity -&gt; Bool)
-&gt; (Directivity -&gt; Directivity -&gt; Bool) -&gt; Eq Directivity
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Directivity -&gt; Directivity -&gt; Bool
$c/= :: Directivity -&gt; Directivity -&gt; Bool
== :: Directivity -&gt; Directivity -&gt; Bool
$c== :: Directivity -&gt; Directivity -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077971"><span id="local-6989586621679077973"><span id="local-6989586621679077975"><span id="local-6989586621679077977"><span id="local-6989586621679077979"><span id="local-6989586621679077981"><span id="local-6989586621679077983"><span class="annot"><span class="annottext">Eq Directivity
Eq Directivity
-&gt; (Directivity -&gt; Directivity -&gt; Ordering)
-&gt; (Directivity -&gt; Directivity -&gt; Bool)
-&gt; (Directivity -&gt; Directivity -&gt; Bool)
-&gt; (Directivity -&gt; Directivity -&gt; Bool)
-&gt; (Directivity -&gt; Directivity -&gt; Bool)
-&gt; (Directivity -&gt; Directivity -&gt; Directivity)
-&gt; (Directivity -&gt; Directivity -&gt; Directivity)
-&gt; Ord Directivity
Directivity -&gt; Directivity -&gt; Bool
Directivity -&gt; Directivity -&gt; Ordering
Directivity -&gt; Directivity -&gt; Directivity
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Directivity -&gt; Directivity -&gt; Directivity
$cmin :: Directivity -&gt; Directivity -&gt; Directivity
max :: Directivity -&gt; Directivity -&gt; Directivity
$cmax :: Directivity -&gt; Directivity -&gt; Directivity
&gt;= :: Directivity -&gt; Directivity -&gt; Bool
$c&gt;= :: Directivity -&gt; Directivity -&gt; Bool
&gt; :: Directivity -&gt; Directivity -&gt; Bool
$c&gt; :: Directivity -&gt; Directivity -&gt; Bool
&lt;= :: Directivity -&gt; Directivity -&gt; Bool
$c&lt;= :: Directivity -&gt; Directivity -&gt; Bool
&lt; :: Directivity -&gt; Directivity -&gt; Bool
$c&lt; :: Directivity -&gt; Directivity -&gt; Bool
compare :: Directivity -&gt; Directivity -&gt; Ordering
$ccompare :: Directivity -&gt; Directivity -&gt; Ordering
$cp1Ord :: Eq Directivity
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077955"><span id="local-6989586621679077957"><span id="local-6989586621679077959"><span id="local-6989586621679077961"><span id="local-6989586621679077963"><span id="local-6989586621679077965"><span id="local-6989586621679077967"><span id="local-6989586621679077969"><span class="annot"><span class="annottext">Int -&gt; Directivity
Directivity -&gt; Int
Directivity -&gt; [Directivity]
Directivity -&gt; Directivity
Directivity -&gt; Directivity -&gt; [Directivity]
Directivity -&gt; Directivity -&gt; Directivity -&gt; [Directivity]
(Directivity -&gt; Directivity)
-&gt; (Directivity -&gt; Directivity)
-&gt; (Int -&gt; Directivity)
-&gt; (Directivity -&gt; Int)
-&gt; (Directivity -&gt; [Directivity])
-&gt; (Directivity -&gt; Directivity -&gt; [Directivity])
-&gt; (Directivity -&gt; Directivity -&gt; [Directivity])
-&gt; (Directivity -&gt; Directivity -&gt; Directivity -&gt; [Directivity])
-&gt; Enum Directivity
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: Directivity -&gt; Directivity -&gt; Directivity -&gt; [Directivity]
$cenumFromThenTo :: Directivity -&gt; Directivity -&gt; Directivity -&gt; [Directivity]
enumFromTo :: Directivity -&gt; Directivity -&gt; [Directivity]
$cenumFromTo :: Directivity -&gt; Directivity -&gt; [Directivity]
enumFromThen :: Directivity -&gt; Directivity -&gt; [Directivity]
$cenumFromThen :: Directivity -&gt; Directivity -&gt; [Directivity]
enumFrom :: Directivity -&gt; [Directivity]
$cenumFrom :: Directivity -&gt; [Directivity]
fromEnum :: Directivity -&gt; Int
$cfromEnum :: Directivity -&gt; Int
toEnum :: Int -&gt; Directivity
$ctoEnum :: Int -&gt; Directivity
pred :: Directivity -&gt; Directivity
$cpred :: Directivity -&gt; Directivity
succ :: Directivity -&gt; Directivity
$csucc :: Directivity -&gt; Directivity
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077950"><span id="local-6989586621679077952"><span class="annot"><span class="annottext">Directivity
Directivity -&gt; Directivity -&gt; Bounded Directivity
forall a. a -&gt; a -&gt; Bounded a
maxBound :: Directivity
$cmaxBound :: Directivity
minBound :: Directivity
$cminBound :: Directivity
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="annot"><a href="APRS.Types.html#parsePosExtension"><span class="hs-identifier hs-type">parsePosExtension</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#PosExtension"><span class="hs-identifier hs-type">PosExtension</span></a></span><span>
</span><span id="line-306"></span><span id="parsePosExtension"><span class="annot"><span class="annottext">parsePosExtension :: Parser PosExtension
</span><a href="APRS.Types.html#parsePosExtension"><span class="hs-identifier hs-var hs-var">parsePosExtension</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser (Int, Double)
</span><a href="APRS.Types.html#parseCourseSpeed"><span class="hs-identifier hs-var">parseCourseSpeed</span></a></span><span> </span><span class="annot"><span class="annottext">Parser (Int, Double)
-&gt; ((Int, Double) -&gt; Parser PosExtension) -&gt; Parser PosExtension
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double -&gt; Parser PosExtension)
-&gt; (Int, Double) -&gt; Parser PosExtension
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">PosExtension -&gt; Parser PosExtension
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PosExtension -&gt; Parser PosExtension)
-&gt; (Double -&gt; PosExtension) -&gt; Double -&gt; Parser PosExtension
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Double -&gt; PosExtension) -&gt; Double -&gt; Parser PosExtension)
-&gt; (Int -&gt; Double -&gt; PosExtension)
-&gt; Int
-&gt; Double
-&gt; Parser PosExtension
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double -&gt; PosExtension
</span><a href="APRS.Types.html#PosECourseSpeed"><span class="hs-identifier hs-var">PosECourseSpeed</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>                    </span><span class="annot"><span class="annottext">Parser PosExtension -&gt; Parser PosExtension -&gt; Parser PosExtension
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser PosExtension
</span><a href="#local-6989586621679077946"><span class="hs-identifier hs-var">parsePHG</span></a></span><span>
</span><span id="line-308"></span><span>                    </span><span class="annot"><span class="annottext">Parser PosExtension -&gt; Parser PosExtension -&gt; Parser PosExtension
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">PosExtension -&gt; Parser PosExtension
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">PosExtension
</span><a href="APRS.Types.html#PosENone"><span class="hs-identifier hs-var">PosENone</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-311"></span><span>    </span><span id="local-6989586621679077946"><span class="annot"><span class="annottext">parsePHG :: Parser PosExtension
</span><a href="#local-6989586621679077946"><span class="hs-identifier hs-var hs-var">parsePHG</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-312"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><span class="hs-identifier hs-var">A.string</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;PHG&quot;</span></span><span>
</span><span id="line-313"></span><span>      </span><span id="local-6989586621679077945"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077945"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.digit</span></span><span>
</span><span id="line-314"></span><span>      </span><span id="local-6989586621679077944"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077944"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.digit</span></span><span>
</span><span id="line-315"></span><span>      </span><span id="local-6989586621679077943"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077943"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.digit</span></span><span>
</span><span id="line-316"></span><span>      </span><span id="local-6989586621679077942"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077942"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Char -&gt; Bool
</span><span class="hs-identifier hs-var">A.inClass</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0-8&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077941"><span class="annot"><span class="annottext">d' :: Directivity
</span><a href="#local-6989586621679077941"><span class="hs-identifier hs-var hs-var">d'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Directivity
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Directivity) -&gt; (Char -&gt; Int) -&gt; Char -&gt; Directivity
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">digitToInt</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077942"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="APRS.Types.html#Directivity"><span class="hs-identifier hs-type">Directivity</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span>      </span><span class="annot"><span class="annottext">PosExtension -&gt; Parser PosExtension
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(PosExtension -&gt; Parser PosExtension)
-&gt; PosExtension -&gt; Parser PosExtension
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Directivity -&gt; PosExtension
</span><a href="APRS.Types.html#PosEPHG"><span class="hs-identifier hs-var">PosEPHG</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">digitToInt</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077945"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Integer -&gt; Int
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">digitToInt</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077944"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">digitToInt</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077943"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Directivity
</span><a href="#local-6989586621679077941"><span class="hs-identifier hs-var">d'</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-keyword">data</span><span> </span><span id="Symbol"><span class="annot"><a href="APRS.Types.html#Symbol"><span class="hs-identifier hs-var">Symbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Symbol"><span class="annot"><a href="APRS.Types.html#Symbol"><span class="hs-identifier hs-var">Symbol</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077934"><span id="local-6989586621679077936"><span id="local-6989586621679077938"><span class="annot"><span class="annottext">Int -&gt; Symbol -&gt; ShowS
[Symbol] -&gt; ShowS
Symbol -&gt; String
(Int -&gt; Symbol -&gt; ShowS)
-&gt; (Symbol -&gt; String) -&gt; ([Symbol] -&gt; ShowS) -&gt; Show Symbol
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Symbol] -&gt; ShowS
$cshowList :: [Symbol] -&gt; ShowS
show :: Symbol -&gt; String
$cshow :: Symbol -&gt; String
showsPrec :: Int -&gt; Symbol -&gt; ShowS
$cshowsPrec :: Int -&gt; Symbol -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077930"><span id="local-6989586621679077932"><span class="annot"><span class="annottext">Symbol -&gt; Symbol -&gt; Bool
(Symbol -&gt; Symbol -&gt; Bool)
-&gt; (Symbol -&gt; Symbol -&gt; Bool) -&gt; Eq Symbol
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Symbol -&gt; Symbol -&gt; Bool
$c/= :: Symbol -&gt; Symbol -&gt; Bool
== :: Symbol -&gt; Symbol -&gt; Bool
$c== :: Symbol -&gt; Symbol -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="hs-keyword">data</span><span> </span><span id="MessageInfo"><span class="annot"><a href="APRS.Types.html#MessageInfo"><span class="hs-identifier hs-var">MessageInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Message"><span class="annot"><a href="APRS.Types.html#Message"><span class="hs-identifier hs-var">Message</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-325"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="MessageACK"><span class="annot"><a href="APRS.Types.html#MessageACK"><span class="hs-identifier hs-var">MessageACK</span></a></span></span><span>
</span><span id="line-326"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="MessageNAK"><span class="annot"><a href="APRS.Types.html#MessageNAK"><span class="hs-identifier hs-var">MessageNAK</span></a></span></span><span>
</span><span id="line-327"></span><span>                   </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077921"><span id="local-6989586621679077923"><span id="local-6989586621679077925"><span class="annot"><span class="annottext">Int -&gt; MessageInfo -&gt; ShowS
[MessageInfo] -&gt; ShowS
MessageInfo -&gt; String
(Int -&gt; MessageInfo -&gt; ShowS)
-&gt; (MessageInfo -&gt; String)
-&gt; ([MessageInfo] -&gt; ShowS)
-&gt; Show MessageInfo
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [MessageInfo] -&gt; ShowS
$cshowList :: [MessageInfo] -&gt; ShowS
show :: MessageInfo -&gt; String
$cshow :: MessageInfo -&gt; String
showsPrec :: Int -&gt; MessageInfo -&gt; ShowS
$cshowsPrec :: Int -&gt; MessageInfo -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077917"><span id="local-6989586621679077919"><span class="annot"><span class="annottext">MessageInfo -&gt; MessageInfo -&gt; Bool
(MessageInfo -&gt; MessageInfo -&gt; Bool)
-&gt; (MessageInfo -&gt; MessageInfo -&gt; Bool) -&gt; Eq MessageInfo
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: MessageInfo -&gt; MessageInfo -&gt; Bool
$c/= :: MessageInfo -&gt; MessageInfo -&gt; Bool
== :: MessageInfo -&gt; MessageInfo -&gt; Bool
$c== :: MessageInfo -&gt; MessageInfo -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-keyword">data</span><span> </span><span id="Capability"><span class="annot"><a href="APRS.Types.html#Capability"><span class="hs-identifier hs-var">Capability</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="IGATE"><span class="annot"><a href="APRS.Types.html#IGATE"><span class="hs-identifier hs-var">IGATE</span></a></span></span><span>
</span><span id="line-330"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="MessageCount"><span class="annot"><a href="APRS.Types.html#MessageCount"><span class="hs-identifier hs-var">MessageCount</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-331"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="LocalCount"><span class="annot"><a href="APRS.Types.html#LocalCount"><span class="hs-identifier hs-var">LocalCount</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-332"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="Capability"><span class="annot"><a href="APRS.Types.html#Capability"><span class="hs-identifier hs-var">Capability</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-333"></span><span>                </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077907"><span id="local-6989586621679077909"><span id="local-6989586621679077911"><span class="annot"><span class="annottext">Int -&gt; Capability -&gt; ShowS
[Capability] -&gt; ShowS
Capability -&gt; String
(Int -&gt; Capability -&gt; ShowS)
-&gt; (Capability -&gt; String)
-&gt; ([Capability] -&gt; ShowS)
-&gt; Show Capability
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Capability] -&gt; ShowS
$cshowList :: [Capability] -&gt; ShowS
show :: Capability -&gt; String
$cshow :: Capability -&gt; String
showsPrec :: Int -&gt; Capability -&gt; ShowS
$cshowsPrec :: Int -&gt; Capability -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077903"><span id="local-6989586621679077905"><span class="annot"><span class="annottext">Capability -&gt; Capability -&gt; Bool
(Capability -&gt; Capability -&gt; Bool)
-&gt; (Capability -&gt; Capability -&gt; Bool) -&gt; Eq Capability
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Capability -&gt; Capability -&gt; Bool
$c/= :: Capability -&gt; Capability -&gt; Bool
== :: Capability -&gt; Capability -&gt; Bool
$c== :: Capability -&gt; Capability -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-keyword">data</span><span> </span><span id="WeatherSW"><span class="annot"><a href="APRS.Types.html#WeatherSW"><span class="hs-identifier hs-var">WeatherSW</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="APRSdos"><span class="annot"><a href="APRS.Types.html#APRSdos"><span class="hs-identifier hs-var">APRSdos</span></a></span></span><span>
</span><span id="line-336"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="MacAPRS"><span class="annot"><a href="APRS.Types.html#MacAPRS"><span class="hs-identifier hs-var">MacAPRS</span></a></span></span><span>
</span><span id="line-337"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="PocketAPRS"><span class="annot"><a href="APRS.Types.html#PocketAPRS"><span class="hs-identifier hs-var">PocketAPRS</span></a></span></span><span>
</span><span id="line-338"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="APRSSA"><span class="annot"><a href="APRS.Types.html#APRSSA"><span class="hs-identifier hs-var">APRSSA</span></a></span></span><span>
</span><span id="line-339"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="WinAPRS"><span class="annot"><a href="APRS.Types.html#WinAPRS"><span class="hs-identifier hs-var">WinAPRS</span></a></span></span><span>
</span><span id="line-340"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="XAPRS"><span class="annot"><a href="APRS.Types.html#XAPRS"><span class="hs-identifier hs-var">XAPRS</span></a></span></span><span>
</span><span id="line-341"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="OpenTracker"><span class="annot"><a href="APRS.Types.html#OpenTracker"><span class="hs-identifier hs-var">OpenTracker</span></a></span></span><span>
</span><span id="line-342"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="Kenwood"><span class="annot"><a href="APRS.Types.html#Kenwood"><span class="hs-identifier hs-var">Kenwood</span></a></span></span><span>
</span><span id="line-343"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="Byonics"><span class="annot"><a href="APRS.Types.html#Byonics"><span class="hs-identifier hs-var">Byonics</span></a></span></span><span>
</span><span id="line-344"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="Yaesu"><span class="annot"><a href="APRS.Types.html#Yaesu"><span class="hs-identifier hs-var">Yaesu</span></a></span></span><span>
</span><span id="line-345"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="UnknownWeatherSW"><span class="annot"><a href="APRS.Types.html#UnknownWeatherSW"><span class="hs-identifier hs-var">UnknownWeatherSW</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-346"></span><span>               </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077888"><span id="local-6989586621679077890"><span class="annot"><span class="annottext">WeatherSW -&gt; WeatherSW -&gt; Bool
(WeatherSW -&gt; WeatherSW -&gt; Bool)
-&gt; (WeatherSW -&gt; WeatherSW -&gt; Bool) -&gt; Eq WeatherSW
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: WeatherSW -&gt; WeatherSW -&gt; Bool
$c/= :: WeatherSW -&gt; WeatherSW -&gt; Bool
== :: WeatherSW -&gt; WeatherSW -&gt; Bool
$c== :: WeatherSW -&gt; WeatherSW -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077873"><span id="local-6989586621679077875"><span id="local-6989586621679077877"><span id="local-6989586621679077879"><span id="local-6989586621679077881"><span id="local-6989586621679077883"><span id="local-6989586621679077885"><span class="annot"><span class="annottext">Eq WeatherSW
Eq WeatherSW
-&gt; (WeatherSW -&gt; WeatherSW -&gt; Ordering)
-&gt; (WeatherSW -&gt; WeatherSW -&gt; Bool)
-&gt; (WeatherSW -&gt; WeatherSW -&gt; Bool)
-&gt; (WeatherSW -&gt; WeatherSW -&gt; Bool)
-&gt; (WeatherSW -&gt; WeatherSW -&gt; Bool)
-&gt; (WeatherSW -&gt; WeatherSW -&gt; WeatherSW)
-&gt; (WeatherSW -&gt; WeatherSW -&gt; WeatherSW)
-&gt; Ord WeatherSW
WeatherSW -&gt; WeatherSW -&gt; Bool
WeatherSW -&gt; WeatherSW -&gt; Ordering
WeatherSW -&gt; WeatherSW -&gt; WeatherSW
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: WeatherSW -&gt; WeatherSW -&gt; WeatherSW
$cmin :: WeatherSW -&gt; WeatherSW -&gt; WeatherSW
max :: WeatherSW -&gt; WeatherSW -&gt; WeatherSW
$cmax :: WeatherSW -&gt; WeatherSW -&gt; WeatherSW
&gt;= :: WeatherSW -&gt; WeatherSW -&gt; Bool
$c&gt;= :: WeatherSW -&gt; WeatherSW -&gt; Bool
&gt; :: WeatherSW -&gt; WeatherSW -&gt; Bool
$c&gt; :: WeatherSW -&gt; WeatherSW -&gt; Bool
&lt;= :: WeatherSW -&gt; WeatherSW -&gt; Bool
$c&lt;= :: WeatherSW -&gt; WeatherSW -&gt; Bool
&lt; :: WeatherSW -&gt; WeatherSW -&gt; Bool
$c&lt; :: WeatherSW -&gt; WeatherSW -&gt; Bool
compare :: WeatherSW -&gt; WeatherSW -&gt; Ordering
$ccompare :: WeatherSW -&gt; WeatherSW -&gt; Ordering
$cp1Ord :: Eq WeatherSW
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077867"><span id="local-6989586621679077869"><span id="local-6989586621679077871"><span class="annot"><span class="annottext">Int -&gt; WeatherSW -&gt; ShowS
[WeatherSW] -&gt; ShowS
WeatherSW -&gt; String
(Int -&gt; WeatherSW -&gt; ShowS)
-&gt; (WeatherSW -&gt; String)
-&gt; ([WeatherSW] -&gt; ShowS)
-&gt; Show WeatherSW
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [WeatherSW] -&gt; ShowS
$cshowList :: [WeatherSW] -&gt; ShowS
show :: WeatherSW -&gt; String
$cshow :: WeatherSW -&gt; String
showsPrec :: Int -&gt; WeatherSW -&gt; ShowS
$cshowsPrec :: Int -&gt; WeatherSW -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="annot"><a href="APRS.Types.html#weatherSWMap"><span class="hs-identifier hs-type">weatherSWMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#WeatherSW"><span class="hs-identifier hs-type">WeatherSW</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-349"></span><span id="weatherSWMap"><span class="annot"><span class="annottext">weatherSWMap :: [(Char, WeatherSW)]
</span><a href="APRS.Types.html#weatherSWMap"><span class="hs-identifier hs-var hs-var">weatherSWMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'d'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WeatherSW
</span><a href="APRS.Types.html#APRSdos"><span class="hs-identifier hs-var">APRSdos</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-350"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'m'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WeatherSW
</span><a href="APRS.Types.html#MacAPRS"><span class="hs-identifier hs-var">MacAPRS</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-351"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'p'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WeatherSW
</span><a href="APRS.Types.html#PocketAPRS"><span class="hs-identifier hs-var">PocketAPRS</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-352"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'s'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WeatherSW
</span><a href="APRS.Types.html#APRSSA"><span class="hs-identifier hs-var">APRSSA</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-353"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'w'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WeatherSW
</span><a href="APRS.Types.html#WinAPRS"><span class="hs-identifier hs-var">WinAPRS</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-354"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'x'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WeatherSW
</span><a href="APRS.Types.html#XAPRS"><span class="hs-identifier hs-var">XAPRS</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-355"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'o'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WeatherSW
</span><a href="APRS.Types.html#OpenTracker"><span class="hs-identifier hs-var">OpenTracker</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-356"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'k'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WeatherSW
</span><a href="APRS.Types.html#Kenwood"><span class="hs-identifier hs-var">Kenwood</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-357"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'b'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WeatherSW
</span><a href="APRS.Types.html#Byonics"><span class="hs-identifier hs-var">Byonics</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-358"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'y'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WeatherSW
</span><a href="APRS.Types.html#Yaesu"><span class="hs-identifier hs-var">Yaesu</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="annot"><a href="APRS.Types.html#lookupWeatherSW"><span class="hs-identifier hs-type">lookupWeatherSW</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="APRS.Types.html#WeatherSW"><span class="hs-identifier hs-type">WeatherSW</span></a></span><span>
</span><span id="line-361"></span><span id="lookupWeatherSW"><span class="annot"><span class="annottext">lookupWeatherSW :: Char -&gt; WeatherSW
</span><a href="APRS.Types.html#lookupWeatherSW"><span class="hs-identifier hs-var hs-var">lookupWeatherSW</span></a></span></span><span> </span><span id="local-6989586621679077865"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077865"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WeatherSW -&gt; Maybe WeatherSW -&gt; WeatherSW
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; WeatherSW
</span><a href="APRS.Types.html#UnknownWeatherSW"><span class="hs-identifier hs-var">UnknownWeatherSW</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077865"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; [(Char, WeatherSW)] -&gt; Maybe WeatherSW
forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077865"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Char, WeatherSW)]
</span><a href="APRS.Types.html#weatherSWMap"><span class="hs-identifier hs-var">weatherSWMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-keyword">data</span><span> </span><span id="WeatherUnit"><span class="annot"><a href="APRS.Types.html#WeatherUnit"><span class="hs-identifier hs-var">WeatherUnit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="WUDavis"><span class="annot"><a href="APRS.Types.html#WUDavis"><span class="hs-identifier hs-var">WUDavis</span></a></span></span><span>
</span><span id="line-364"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="WUDavisVantagePro"><span class="annot"><a href="APRS.Types.html#WUDavisVantagePro"><span class="hs-identifier hs-var">WUDavisVantagePro</span></a></span></span><span>
</span><span id="line-365"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="WUHeathkit"><span class="annot"><a href="APRS.Types.html#WUHeathkit"><span class="hs-identifier hs-var">WUHeathkit</span></a></span></span><span>
</span><span id="line-366"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="WUPIC"><span class="annot"><a href="APRS.Types.html#WUPIC"><span class="hs-identifier hs-var">WUPIC</span></a></span></span><span>
</span><span id="line-367"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="WURadioShack"><span class="annot"><a href="APRS.Types.html#WURadioShack"><span class="hs-identifier hs-var">WURadioShack</span></a></span></span><span>
</span><span id="line-368"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="WUUltimeterIIAuto"><span class="annot"><a href="APRS.Types.html#WUUltimeterIIAuto"><span class="hs-identifier hs-var">WUUltimeterIIAuto</span></a></span></span><span>
</span><span id="line-369"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="WUUltimeterIIRemote"><span class="annot"><a href="APRS.Types.html#WUUltimeterIIRemote"><span class="hs-identifier hs-var">WUUltimeterIIRemote</span></a></span></span><span>
</span><span id="line-370"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="WUUltimeter2000"><span class="annot"><a href="APRS.Types.html#WUUltimeter2000"><span class="hs-identifier hs-var">WUUltimeter2000</span></a></span></span><span>
</span><span id="line-371"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="WUUltimeterRemote"><span class="annot"><a href="APRS.Types.html#WUUltimeterRemote"><span class="hs-identifier hs-var">WUUltimeterRemote</span></a></span></span><span>
</span><span id="line-372"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="WUUltimeter500"><span class="annot"><a href="APRS.Types.html#WUUltimeter500"><span class="hs-identifier hs-var">WUUltimeter500</span></a></span></span><span>
</span><span id="line-373"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="WURemoteUltimeterPacket"><span class="annot"><a href="APRS.Types.html#WURemoteUltimeterPacket"><span class="hs-identifier hs-var">WURemoteUltimeterPacket</span></a></span></span><span>
</span><span id="line-374"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="WUOpenTrackerTW1"><span class="annot"><a href="APRS.Types.html#WUOpenTrackerTW1"><span class="hs-identifier hs-var">WUOpenTrackerTW1</span></a></span></span><span>
</span><span id="line-375"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span id="UnknownWeatherUnit"><span class="annot"><a href="APRS.Types.html#UnknownWeatherUnit"><span class="hs-identifier hs-var">UnknownWeatherUnit</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-376"></span><span>                 </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077845"><span id="local-6989586621679077847"><span id="local-6989586621679077849"><span class="annot"><span class="annottext">Int -&gt; WeatherUnit -&gt; ShowS
[WeatherUnit] -&gt; ShowS
WeatherUnit -&gt; String
(Int -&gt; WeatherUnit -&gt; ShowS)
-&gt; (WeatherUnit -&gt; String)
-&gt; ([WeatherUnit] -&gt; ShowS)
-&gt; Show WeatherUnit
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [WeatherUnit] -&gt; ShowS
$cshowList :: [WeatherUnit] -&gt; ShowS
show :: WeatherUnit -&gt; String
$cshow :: WeatherUnit -&gt; String
showsPrec :: Int -&gt; WeatherUnit -&gt; ShowS
$cshowsPrec :: Int -&gt; WeatherUnit -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077841"><span id="local-6989586621679077843"><span class="annot"><span class="annottext">WeatherUnit -&gt; WeatherUnit -&gt; Bool
(WeatherUnit -&gt; WeatherUnit -&gt; Bool)
-&gt; (WeatherUnit -&gt; WeatherUnit -&gt; Bool) -&gt; Eq WeatherUnit
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: WeatherUnit -&gt; WeatherUnit -&gt; Bool
$c/= :: WeatherUnit -&gt; WeatherUnit -&gt; Bool
== :: WeatherUnit -&gt; WeatherUnit -&gt; Bool
$c== :: WeatherUnit -&gt; WeatherUnit -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="annot"><a href="APRS.Types.html#parseWeatherUnit"><span class="hs-identifier hs-type">parseWeatherUnit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#WeatherUnit"><span class="hs-identifier hs-type">WeatherUnit</span></a></span><span>
</span><span id="line-379"></span><span id="parseWeatherUnit"><span class="annot"><span class="annottext">parseWeatherUnit :: Parser WeatherUnit
</span><a href="APRS.Types.html#parseWeatherUnit"><span class="hs-identifier hs-var hs-var">parseWeatherUnit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-380"></span><span>  </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;Dvs&quot;</span></span><span>           </span><span class="annot"><span class="annottext">Parser Text -&gt; WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WeatherUnit
</span><a href="APRS.Types.html#WUDavis"><span class="hs-identifier hs-var">WUDavis</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span class="annot"><span class="annottext">Parser WeatherUnit -&gt; Parser WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;DsVP&quot;</span></span><span>      </span><span class="annot"><span class="annottext">Parser Text -&gt; WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WeatherUnit
</span><a href="APRS.Types.html#WUDavisVantagePro"><span class="hs-identifier hs-var">WUDavisVantagePro</span></a></span><span>
</span><span id="line-382"></span><span>  </span><span class="annot"><span class="annottext">Parser WeatherUnit -&gt; Parser WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;HKT&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Parser Text -&gt; WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WeatherUnit
</span><a href="APRS.Types.html#WUHeathkit"><span class="hs-identifier hs-var">WUHeathkit</span></a></span><span>
</span><span id="line-383"></span><span>  </span><span class="annot"><span class="annottext">Parser WeatherUnit -&gt; Parser WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;PIC&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Parser Text -&gt; WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WeatherUnit
</span><a href="APRS.Types.html#WUPIC"><span class="hs-identifier hs-var">WUPIC</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span class="annot"><span class="annottext">Parser WeatherUnit -&gt; Parser WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;RSW&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Parser Text -&gt; WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WeatherUnit
</span><a href="APRS.Types.html#WURadioShack"><span class="hs-identifier hs-var">WURadioShack</span></a></span><span>
</span><span id="line-385"></span><span>  </span><span class="annot"><span class="annottext">Parser WeatherUnit -&gt; Parser WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;U-II&quot;</span></span><span>      </span><span class="annot"><span class="annottext">Parser Text -&gt; WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WeatherUnit
</span><a href="APRS.Types.html#WUUltimeterIIAuto"><span class="hs-identifier hs-var">WUUltimeterIIAuto</span></a></span><span>
</span><span id="line-386"></span><span>  </span><span class="annot"><span class="annottext">Parser WeatherUnit -&gt; Parser WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;U2R&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Parser Text -&gt; WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WeatherUnit
</span><a href="APRS.Types.html#WUUltimeterIIRemote"><span class="hs-identifier hs-var">WUUltimeterIIRemote</span></a></span><span>
</span><span id="line-387"></span><span>  </span><span class="annot"><span class="annottext">Parser WeatherUnit -&gt; Parser WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;U2k&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Parser Text -&gt; WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WeatherUnit
</span><a href="APRS.Types.html#WUUltimeter2000"><span class="hs-identifier hs-var">WUUltimeter2000</span></a></span><span>
</span><span id="line-388"></span><span>  </span><span class="annot"><span class="annottext">Parser WeatherUnit -&gt; Parser WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;U2kr&quot;</span></span><span>      </span><span class="annot"><span class="annottext">Parser Text -&gt; WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WeatherUnit
</span><a href="APRS.Types.html#WUUltimeterRemote"><span class="hs-identifier hs-var">WUUltimeterRemote</span></a></span><span>
</span><span id="line-389"></span><span>  </span><span class="annot"><span class="annottext">Parser WeatherUnit -&gt; Parser WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;U5&quot;</span></span><span>        </span><span class="annot"><span class="annottext">Parser Text -&gt; WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WeatherUnit
</span><a href="APRS.Types.html#WUUltimeter500"><span class="hs-identifier hs-var">WUUltimeter500</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span class="annot"><span class="annottext">Parser WeatherUnit -&gt; Parser WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;Upkm&quot;</span></span><span>      </span><span class="annot"><span class="annottext">Parser Text -&gt; WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WeatherUnit
</span><a href="APRS.Types.html#WURemoteUltimeterPacket"><span class="hs-identifier hs-var">WURemoteUltimeterPacket</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span class="annot"><span class="annottext">Parser WeatherUnit -&gt; Parser WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;TW1&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Parser Text -&gt; WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">WeatherUnit
</span><a href="APRS.Types.html#WUOpenTrackerTW1"><span class="hs-identifier hs-var">WUOpenTrackerTW1</span></a></span><span>
</span><span id="line-392"></span><span>  </span><span class="annot"><span class="annottext">Parser WeatherUnit -&gt; Parser WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Parser Text
</span><span class="hs-identifier hs-var">A.take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>  </span><span class="annot"><span class="annottext">Parser Text -&gt; (Text -&gt; Parser WeatherUnit) -&gt; Parser WeatherUnit
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span class="annot"><span class="annottext">(WeatherUnit -&gt; Parser WeatherUnit)
-&gt; (Text -&gt; WeatherUnit) -&gt; Text -&gt; Parser WeatherUnit
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text -&gt; WeatherUnit
</span><a href="APRS.Types.html#UnknownWeatherUnit"><span class="hs-identifier hs-var">UnknownWeatherUnit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="hs-keyword">data</span><span> </span><span id="ObjectData"><span class="annot"><a href="APRS.Types.html#ObjectData"><span class="hs-identifier hs-var">ObjectData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ObjText"><span class="annot"><a href="APRS.Types.html#ObjText"><span class="hs-identifier hs-var">ObjText</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-395"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="ObjWeather"><span class="annot"><a href="APRS.Types.html#ObjWeather"><span class="hs-identifier hs-var">ObjWeather</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="APRS.Types.html#WeatherParam"><span class="hs-identifier hs-type">WeatherParam</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-396"></span><span>                </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077831"><span id="local-6989586621679077833"><span id="local-6989586621679077835"><span class="annot"><span class="annottext">Int -&gt; ObjectData -&gt; ShowS
[ObjectData] -&gt; ShowS
ObjectData -&gt; String
(Int -&gt; ObjectData -&gt; ShowS)
-&gt; (ObjectData -&gt; String)
-&gt; ([ObjectData] -&gt; ShowS)
-&gt; Show ObjectData
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ObjectData] -&gt; ShowS
$cshowList :: [ObjectData] -&gt; ShowS
show :: ObjectData -&gt; String
$cshow :: ObjectData -&gt; String
showsPrec :: Int -&gt; ObjectData -&gt; ShowS
$cshowsPrec :: Int -&gt; ObjectData -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077827"><span id="local-6989586621679077829"><span class="annot"><span class="annottext">ObjectData -&gt; ObjectData -&gt; Bool
(ObjectData -&gt; ObjectData -&gt; Bool)
-&gt; (ObjectData -&gt; ObjectData -&gt; Bool) -&gt; Eq ObjectData
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ObjectData -&gt; ObjectData -&gt; Bool
$c/= :: ObjectData -&gt; ObjectData -&gt; Bool
== :: ObjectData -&gt; ObjectData -&gt; Bool
$c== :: ObjectData -&gt; ObjectData -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-comment">-- TODO:  Include extensions from page 27 in position packets</span><span>
</span><span id="line-399"></span><span class="hs-keyword">data</span><span> </span><span id="APRSPacket"><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-var">APRSPacket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PositionPacket"><span class="annot"><a href="APRS.Types.html#PositionPacket"><span class="hs-identifier hs-var">PositionPacket</span></a></span></span><span> </span><span class="annot"><a href="APRS.Types.html#PacketType"><span class="hs-identifier hs-type">PacketType</span></a></span><span> </span><span class="annot"><a href="APRS.Types.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-400"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="ObjectPacket"><span class="annot"><a href="APRS.Types.html#ObjectPacket"><span class="hs-identifier hs-var">ObjectPacket</span></a></span></span><span> </span><span class="annot"><a href="APRS.Types.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span class="annot"><a href="APRS.Types.html#ObjectState"><span class="hs-identifier hs-type">ObjectState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="annot"><a href="APRS.Types.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span> </span><span class="annot"><a href="APRS.Types.html#ObjectData"><span class="hs-identifier hs-type">ObjectData</span></a></span><span>
</span><span id="line-401"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="ItemPacket"><span class="annot"><a href="APRS.Types.html#ItemPacket"><span class="hs-identifier hs-var">ItemPacket</span></a></span></span><span> </span><span class="annot"><a href="APRS.Types.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span class="annot"><a href="APRS.Types.html#ObjectState"><span class="hs-identifier hs-type">ObjectState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-402"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="WeatherPacket"><span class="annot"><a href="APRS.Types.html#WeatherPacket"><span class="hs-identifier hs-var">WeatherPacket</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="APRS.Types.html#WeatherParam"><span class="hs-identifier hs-type">WeatherParam</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><a href="APRS.Types.html#WeatherSW"><span class="hs-identifier hs-type">WeatherSW</span></a></span><span> </span><span class="annot"><a href="APRS.Types.html#WeatherUnit"><span class="hs-identifier hs-type">WeatherUnit</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-403"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="StatusPacket"><span class="annot"><a href="APRS.Types.html#StatusPacket"><span class="hs-identifier hs-var">StatusPacket</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-404"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="MessagePacket"><span class="annot"><a href="APRS.Types.html#MessagePacket"><span class="hs-identifier hs-var">MessagePacket</span></a></span></span><span> </span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="annot"><a href="APRS.Types.html#MessageInfo"><span class="hs-identifier hs-type">MessageInfo</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-comment">-- includes sequence number</span><span>
</span><span id="line-405"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="TelemetryPacket"><span class="annot"><a href="APRS.Types.html#TelemetryPacket"><span class="hs-identifier hs-var">TelemetryPacket</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word8</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-comment">-- seq, vals, bits, comment</span><span>
</span><span id="line-406"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="MicEPacket"><span class="annot"><a href="APRS.Types.html#MicEPacket"><span class="hs-identifier hs-var">MicEPacket</span></a></span></span><span> </span><span class="annot"><a href="APRS.Types.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-407"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="RawGPSPacket"><span class="annot"><a href="APRS.Types.html#RawGPSPacket"><span class="hs-identifier hs-var">RawGPSPacket</span></a></span></span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="annot"><a href="APRS.Types.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span>
</span><span id="line-408"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="CapabilitiesPacket"><span class="annot"><a href="APRS.Types.html#CapabilitiesPacket"><span class="hs-identifier hs-var">CapabilitiesPacket</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="APRS.Types.html#Capability"><span class="hs-identifier hs-type">Capability</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-409"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="NotUnderstoodPacket"><span class="annot"><a href="APRS.Types.html#NotUnderstoodPacket"><span class="hs-identifier hs-var">NotUnderstoodPacket</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-410"></span><span>                </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077815"><span id="local-6989586621679077817"><span id="local-6989586621679077819"><span class="annot"><span class="annottext">Int -&gt; APRSPacket -&gt; ShowS
[APRSPacket] -&gt; ShowS
APRSPacket -&gt; String
(Int -&gt; APRSPacket -&gt; ShowS)
-&gt; (APRSPacket -&gt; String)
-&gt; ([APRSPacket] -&gt; ShowS)
-&gt; Show APRSPacket
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [APRSPacket] -&gt; ShowS
$cshowList :: [APRSPacket] -&gt; ShowS
show :: APRSPacket -&gt; String
$cshow :: APRSPacket -&gt; String
showsPrec :: Int -&gt; APRSPacket -&gt; ShowS
$cshowsPrec :: Int -&gt; APRSPacket -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077811"><span id="local-6989586621679077813"><span class="annot"><span class="annottext">APRSPacket -&gt; APRSPacket -&gt; Bool
(APRSPacket -&gt; APRSPacket -&gt; Bool)
-&gt; (APRSPacket -&gt; APRSPacket -&gt; Bool) -&gt; Eq APRSPacket
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: APRSPacket -&gt; APRSPacket -&gt; Bool
$c/= :: APRSPacket -&gt; APRSPacket -&gt; Bool
== :: APRSPacket -&gt; APRSPacket -&gt; Bool
$c== :: APRSPacket -&gt; APRSPacket -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="annot"><a href="APRS.Types.html#symbol"><span class="hs-identifier hs-type">symbol</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="APRS.Types.html#Frame"><span class="hs-identifier hs-type">Frame</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span>
</span><span id="line-413"></span><span id="symbol"><span class="annot"><span class="annottext">symbol :: Frame -&gt; Maybe Symbol
</span><a href="APRS.Types.html#symbol"><span class="hs-identifier hs-var hs-var">symbol</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Frame"><span class="hs-identifier hs-type">Frame</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#PositionPacket"><span class="hs-identifier hs-type">PositionPacket</span></a></span><span> </span><span class="annot"><span class="annottext">PacketType
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679077810"><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679077810"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Symbol -&gt; Maybe Symbol
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679077810"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-414"></span><span class="annot"><a href="APRS.Types.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Frame"><span class="hs-identifier hs-type">Frame</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#ObjectPacket"><span class="hs-identifier hs-type">ObjectPacket</span></a></span><span> </span><span id="local-6989586621679077809"><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679077809"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">ObjectState
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Timestamp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">ObjectData
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Symbol -&gt; Maybe Symbol
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679077809"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-415"></span><span class="annot"><a href="APRS.Types.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Frame"><span class="hs-identifier hs-type">Frame</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#ItemPacket"><span class="hs-identifier hs-type">ItemPacket</span></a></span><span> </span><span id="local-6989586621679077808"><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679077808"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">ObjectState
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Symbol -&gt; Maybe Symbol
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679077808"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-416"></span><span class="annot"><a href="APRS.Types.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Frame"><span class="hs-identifier hs-type">Frame</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#MicEPacket"><span class="hs-identifier hs-type">MicEPacket</span></a></span><span> </span><span id="local-6989586621679077807"><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679077807"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Symbol -&gt; Maybe Symbol
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679077807"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-417"></span><span class="annot"><a href="APRS.Types.html#symbol"><span class="hs-identifier hs-var">symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Frame
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Symbol
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="annot"><a href="APRS.Types.html#bodyParser"><span class="hs-identifier hs-type">bodyParser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-type">APRSPacket</span></a></span><span>
</span><span id="line-421"></span><span id="bodyParser"><span class="annot"><span class="annottext">bodyParser :: Address -&gt; Parser APRSPacket
</span><a href="APRS.Types.html#bodyParser"><span class="hs-identifier hs-var hs-var">bodyParser</span></a></span></span><span> </span><span id="local-6989586621679077806"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679077806"><span class="hs-identifier hs-var">dest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser APRSPacket
</span><a href="APRS.Types.html#parseWeatherPacket"><span class="hs-identifier hs-var">parseWeatherPacket</span></a></span><span>
</span><span id="line-422"></span><span>                  </span><span class="annot"><span class="annottext">Parser APRSPacket -&gt; Parser APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser APRSPacket
</span><a href="APRS.Types.html#parseObjectPacket"><span class="hs-identifier hs-var">parseObjectPacket</span></a></span><span>
</span><span id="line-423"></span><span>                  </span><span class="annot"><span class="annottext">Parser APRSPacket -&gt; Parser APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser APRSPacket
</span><a href="APRS.Types.html#parseItemPacket"><span class="hs-identifier hs-var">parseItemPacket</span></a></span><span>
</span><span id="line-424"></span><span>                  </span><span class="annot"><span class="annottext">Parser APRSPacket -&gt; Parser APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser APRSPacket
</span><a href="APRS.Types.html#parseStatusPacket"><span class="hs-identifier hs-var">parseStatusPacket</span></a></span><span>
</span><span id="line-425"></span><span>                  </span><span class="annot"><span class="annottext">Parser APRSPacket -&gt; Parser APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser APRSPacket
</span><a href="APRS.Types.html#parseCapabilityPacket"><span class="hs-identifier hs-var">parseCapabilityPacket</span></a></span><span>
</span><span id="line-426"></span><span>                  </span><span class="annot"><span class="annottext">Parser APRSPacket -&gt; Parser APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser APRSPacket
</span><a href="APRS.Types.html#parseMessagePacket"><span class="hs-identifier hs-var">parseMessagePacket</span></a></span><span>
</span><span id="line-427"></span><span>                  </span><span class="annot"><span class="annottext">Parser APRSPacket -&gt; Parser APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser APRSPacket
</span><a href="APRS.Types.html#parseTelemetry"><span class="hs-identifier hs-var">parseTelemetry</span></a></span><span>
</span><span id="line-428"></span><span>                  </span><span class="annot"><span class="annottext">Parser APRSPacket -&gt; Parser APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Address -&gt; Parser APRSPacket
</span><a href="APRS.Types.html#parseMicE"><span class="hs-identifier hs-var">parseMicE</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679077806"><span class="hs-identifier hs-var">dest</span></a></span><span>
</span><span id="line-429"></span><span>                  </span><span class="annot"><span class="annottext">Parser APRSPacket -&gt; Parser APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser APRSPacket
</span><a href="APRS.Types.html#parseNMEA"><span class="hs-identifier hs-var">parseNMEA</span></a></span><span>
</span><span id="line-430"></span><span>                  </span><span class="annot"><span class="annottext">Parser APRSPacket -&gt; Parser APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser APRSPacket
</span><a href="APRS.Types.html#parsePositionPacket"><span class="hs-identifier hs-var">parsePositionPacket</span></a></span><span>
</span><span id="line-431"></span><span>                  </span><span class="annot"><span class="annottext">Parser APRSPacket -&gt; Parser APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; APRSPacket
</span><a href="APRS.Types.html#NotUnderstoodPacket"><span class="hs-identifier hs-var">NotUnderstoodPacket</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; APRSPacket) -&gt; Parser Text -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-identifier hs-var">A.takeText</span></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="annot"><a href="APRS.Types.html#parseNMEA"><span class="hs-identifier hs-type">parseNMEA</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-type">APRSPacket</span></a></span><span>
</span><span id="line-434"></span><span id="parseNMEA"><span class="annot"><span class="annottext">parseNMEA :: Parser APRSPacket
</span><a href="APRS.Types.html#parseNMEA"><span class="hs-identifier hs-var hs-var">parseNMEA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679077794"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077794"><span class="hs-identifier hs-var">lat</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077793"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077793"><span class="hs-identifier hs-var">lon</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077792"><span class="annot"><span class="annottext">(Int, Int, Int)
</span><a href="#local-6989586621679077792"><span class="hs-identifier hs-var">ts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser (Double, Double, (Int, Int, Int))
</span><a href="APRS.NMEA.html#parseNMEA"><span class="hs-identifier hs-var">N.parseNMEA</span></a></span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-comment">-- TODO: Altitude</span><span>
</span><span id="line-437"></span><span>  </span><span class="annot"><span class="annottext">APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(APRSPacket -&gt; Parser APRSPacket)
-&gt; APRSPacket -&gt; Parser APRSPacket
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Timestamp -&gt; APRSPacket
</span><a href="APRS.Types.html#RawGPSPacket"><span class="hs-identifier hs-var">RawGPSPacket</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double, Double, PosExtension) -&gt; Position
</span><a href="APRS.Types.html#Position"><span class="hs-identifier hs-var">Position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077794"><span class="hs-identifier hs-var">lat</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077793"><span class="hs-identifier hs-var">lon</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PosExtension
</span><a href="APRS.Types.html#PosENone"><span class="hs-identifier hs-var">PosENone</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int, Int, Int) -&gt; Timestamp
</span><a href="APRS.Types.html#HMS"><span class="hs-identifier hs-var">HMS</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int, Int)
</span><a href="#local-6989586621679077792"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="annot"><a href="APRS.Types.html#parseCapabilityPacket"><span class="hs-identifier hs-type">parseCapabilityPacket</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-type">APRSPacket</span></a></span><span>
</span><span id="line-440"></span><span id="parseCapabilityPacket"><span class="annot"><span class="annottext">parseCapabilityPacket :: Parser APRSPacket
</span><a href="APRS.Types.html#parseCapabilityPacket"><span class="hs-identifier hs-var hs-var">parseCapabilityPacket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-441"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&lt;'</span></span><span>
</span><span id="line-442"></span><span>  </span><span id="local-6989586621679077790"><span class="annot"><span class="annottext">[Capability]
</span><a href="#local-6989586621679077790"><span class="hs-identifier hs-var">caps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Capability
-&gt; Parser Text Char -&gt; Parser Text [Capability]
forall (f :: * -&gt; *) a s. Alternative f =&gt; f a -&gt; f s -&gt; f [a]
</span><span class="hs-identifier hs-var">A.sepBy</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Capability
</span><a href="#local-6989586621679077789"><span class="hs-identifier hs-var">cap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679077788"><span class="hs-identifier hs-var">isSep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>  </span><span class="annot"><span class="annottext">APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(APRSPacket -&gt; Parser APRSPacket)
-&gt; APRSPacket -&gt; Parser APRSPacket
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Capability] -&gt; APRSPacket
</span><a href="APRS.Types.html#CapabilitiesPacket"><span class="hs-identifier hs-var">CapabilitiesPacket</span></a></span><span> </span><span class="annot"><span class="annottext">[Capability]
</span><a href="#local-6989586621679077790"><span class="hs-identifier hs-var">caps</span></a></span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-446"></span><span>    </span><span id="local-6989586621679077788"><span class="annot"><span class="annottext">isSep :: Char -&gt; Bool
</span><a href="#local-6989586621679077788"><span class="hs-identifier hs-var hs-var">isSep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><a href="#local-6989586621679077789"><span class="hs-identifier hs-type">cap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Capability"><span class="hs-identifier hs-type">Capability</span></a></span><span>
</span><span id="line-448"></span><span>    </span><span id="local-6989586621679077789"><span class="annot"><span class="annottext">cap :: Parser Text Capability
</span><a href="#local-6989586621679077789"><span class="hs-identifier hs-var hs-var">cap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><span class="hs-identifier hs-var">A.string</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;IGATE&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text Capability -&gt; Parser Text Capability
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Capability -&gt; Parser Text Capability
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Capability
</span><a href="APRS.Types.html#IGATE"><span class="hs-identifier hs-var">IGATE</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>          </span><span class="annot"><span class="annottext">Parser Text Capability
-&gt; Parser Text Capability -&gt; Parser Text Capability
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;MSG_CNT=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text Capability -&gt; Parser Text Capability
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Capability
</span><a href="APRS.Types.html#MessageCount"><span class="hs-identifier hs-var">MessageCount</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Capability) -&gt; Parser Text Int -&gt; Parser Text Capability
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Int
forall a. Integral a =&gt; Parser a
</span><span class="hs-identifier hs-var">A.decimal</span></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>          </span><span class="annot"><span class="annottext">Parser Text Capability
-&gt; Parser Text Capability -&gt; Parser Text Capability
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;LOC_CNT=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text Capability -&gt; Parser Text Capability
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Capability
</span><a href="APRS.Types.html#LocalCount"><span class="hs-identifier hs-var">LocalCount</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Capability) -&gt; Parser Text Int -&gt; Parser Text Capability
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Int
forall a. Integral a =&gt; Parser a
</span><span class="hs-identifier hs-var">A.decimal</span></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>          </span><span class="annot"><span class="annottext">Parser Text Capability
-&gt; Parser Text Capability -&gt; Parser Text Capability
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Capability
</span><a href="#local-6989586621679077786"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><a href="#local-6989586621679077786"><span class="hs-identifier hs-type">other</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Capability"><span class="hs-identifier hs-type">Capability</span></a></span><span>
</span><span id="line-454"></span><span>    </span><span id="local-6989586621679077786"><span class="annot"><span class="annottext">other :: Parser Text Capability
</span><a href="#local-6989586621679077786"><span class="hs-identifier hs-var hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-455"></span><span>      </span><span id="local-6989586621679077785"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077785"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text
</span><span class="hs-identifier hs-var">A.takeTill</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>      </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>      </span><span id="local-6989586621679077783"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077783"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text
</span><span class="hs-identifier hs-var">A.takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Char -&gt; Bool) -&gt; Char -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679077788"><span class="hs-identifier hs-var">isSep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>      </span><span class="annot"><span class="annottext">Capability -&gt; Parser Text Capability
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Capability -&gt; Parser Text Capability)
-&gt; Capability -&gt; Parser Text Capability
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Capability
</span><a href="APRS.Types.html#Capability"><span class="hs-identifier hs-var">Capability</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077785"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077783"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="hs-comment">{-
|       | No MSG | MSG |
| NO TS | !      | =   |
| TS    | /      | @   |
-}</span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="annot"><a href="APRS.Types.html#parsePosition"><span class="hs-identifier hs-type">parsePosition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span id="parsePosition"><span class="annot"><span class="annottext">parsePosition :: Parser (Symbol, Position)
</span><a href="APRS.Types.html#parsePosition"><span class="hs-identifier hs-var hs-var">parsePosition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser (Symbol, Position)
</span><a href="APRS.Types.html#parsePosUncompressed"><span class="hs-identifier hs-var">parsePosUncompressed</span></a></span><span> </span><span class="annot"><span class="annottext">Parser (Symbol, Position)
-&gt; Parser (Symbol, Position) -&gt; Parser (Symbol, Position)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser (Symbol, Position)
</span><a href="APRS.Types.html#parsePosCompressed"><span class="hs-identifier hs-var">parsePosCompressed</span></a></span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span class="annot"><a href="APRS.Types.html#parsePosCompressed"><span class="hs-identifier hs-type">parsePosCompressed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span id="parsePosCompressed"><span class="annot"><span class="annottext">parsePosCompressed :: Parser (Symbol, Position)
</span><a href="APRS.Types.html#parsePosCompressed"><span class="hs-identifier hs-var hs-var">parsePosCompressed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-471"></span><span>  </span><span id="local-6989586621679077778"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077778"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.anyChar</span></span><span>
</span><span id="line-472"></span><span>  </span><span id="local-6989586621679077776"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077776"><span class="hs-identifier hs-var">b91a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Double
</span><a href="APRS.Types.html#parseB91Seg"><span class="hs-identifier hs-var">parseB91Seg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-473"></span><span>  </span><span id="local-6989586621679077775"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077775"><span class="hs-identifier hs-var">b91b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Double
</span><a href="APRS.Types.html#parseB91Seg"><span class="hs-identifier hs-var">parseB91Seg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-474"></span><span>  </span><span id="local-6989586621679077774"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077774"><span class="hs-identifier hs-var">sym</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.anyChar</span></span><span> </span><span class="hs-comment">-- symbol code</span><span>
</span><span id="line-475"></span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-comment">-- It seems that xastir will just truncate the packet once it has enough stuff.</span><span>
</span><span id="line-477"></span><span>  </span><span id="local-6989586621679077773"><span class="annot"><span class="annottext">PosExtension
</span><a href="#local-6989586621679077773"><span class="hs-identifier hs-var">ext</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser PosExtension
</span><a href="#local-6989586621679077772"><span class="hs-identifier hs-var">pcvel</span></a></span><span> </span><span class="annot"><span class="annottext">Parser PosExtension -&gt; Parser PosExtension -&gt; Parser PosExtension
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">PosExtension -&gt; Parser PosExtension
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">PosExtension
</span><a href="APRS.Types.html#PosENone"><span class="hs-identifier hs-var">PosENone</span></a></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span>  </span><span class="annot"><span class="annottext">(Symbol, Position) -&gt; Parser (Symbol, Position)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Symbol
</span><a href="APRS.Types.html#Symbol"><span class="hs-identifier hs-var">Symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077778"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077774"><span class="hs-identifier hs-var">sym</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Double, Double, Double, PosExtension) -&gt; Position
</span><a href="APRS.Types.html#Position"><span class="hs-identifier hs-var">Position</span></a></span><span> </span><span class="annot"><span class="annottext">((Double, Double, Double, PosExtension) -&gt; Position)
-&gt; (Double, Double, Double, PosExtension) -&gt; Position
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
-&gt; Double -&gt; PosExtension -&gt; (Double, Double, Double, PosExtension)
forall a b c d.
(Fractional a, Fractional b, Num c) =&gt;
a -&gt; b -&gt; d -&gt; (a, b, c, d)
</span><a href="#local-6989586621679077771"><span class="hs-identifier hs-var">unc</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077776"><span class="hs-identifier hs-var">b91a</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077775"><span class="hs-identifier hs-var">b91b</span></a></span><span> </span><span class="annot"><span class="annottext">PosExtension
</span><a href="#local-6989586621679077773"><span class="hs-identifier hs-var">ext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-482"></span><span>    </span><span class="hs-comment">-- TODO: Altitude</span><span>
</span><span id="line-483"></span><span>    </span><span id="local-6989586621679077771"><span class="annot"><span class="annottext">unc :: a -&gt; b -&gt; d -&gt; (a, b, c, d)
</span><a href="#local-6989586621679077771"><span class="hs-identifier hs-var hs-var">unc</span></a></span></span><span> </span><span id="local-6989586621679077770"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077770"><span class="hs-identifier hs-var">m1</span></a></span></span><span> </span><span id="local-6989586621679077769"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077769"><span class="hs-identifier hs-var">m2</span></a></span></span><span> </span><span id="local-6989586621679077768"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679077768"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-number">90</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077770"><span class="hs-identifier hs-var">m1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">380926</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">b
</span><span class="hs-number">180</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679077769"><span class="hs-identifier hs-var">m2</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">190463</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679077768"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>    </span><span class="annot"><a href="#local-6989586621679077772"><span class="hs-identifier hs-type">pcvel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#PosExtension"><span class="hs-identifier hs-type">PosExtension</span></a></span><span>
</span><span id="line-485"></span><span>    </span><span id="local-6989586621679077772"><span class="annot"><span class="annottext">pcvel :: Parser PosExtension
</span><a href="#local-6989586621679077772"><span class="hs-identifier hs-var hs-var">pcvel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; PosExtension
forall a. Integral a =&gt; [a] -&gt; PosExtension
</span><a href="#local-6989586621679077767"><span class="hs-identifier hs-var">pcvel'</span></a></span><span> </span><span class="annot"><span class="annottext">([Int] -&gt; PosExtension)
-&gt; (String -&gt; [Int]) -&gt; String -&gt; PosExtension
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Int) -&gt; String -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; PosExtension)
-&gt; Parser Text String -&gt; Parser PosExtension
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.anyChar</span></span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span>    </span><span id="local-6989586621679077767"><span class="annot"><span class="annottext">pcvel' :: [a] -&gt; PosExtension
</span><a href="#local-6989586621679077767"><span class="hs-identifier hs-var hs-var">pcvel'</span></a></span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679077766"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077766"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077765"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077765"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span>
</span><span id="line-488"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077766"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">33</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077766"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">122</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077762"><span class="annot"><span class="annottext">course :: Int
</span><a href="#local-6989586621679077762"><span class="hs-identifier hs-var hs-var">course</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077766"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">33</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-489"></span><span>                                  </span><span id="local-6989586621679077761"><span class="annot"><span class="annottext">speed :: Double
</span><a href="#local-6989586621679077761"><span class="hs-identifier hs-var hs-var">speed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.852</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.08</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; a -&gt; Double
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679077765"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">33</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>                                  </span><span id="local-6989586621679077760"><span class="annot"><span class="annottext">course' :: Int
</span><a href="#local-6989586621679077760"><span class="hs-identifier hs-var hs-var">course'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077762"><span class="hs-identifier hs-var">course</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">360</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077762"><span class="hs-identifier hs-var">course</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-491"></span><span>                                </span><span class="annot"><span class="annottext">Int -&gt; Double -&gt; PosExtension
</span><a href="APRS.Types.html#PosECourseSpeed"><span class="hs-identifier hs-var">PosECourseSpeed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077760"><span class="hs-identifier hs-var">course'</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077761"><span class="hs-identifier hs-var">speed</span></a></span><span>
</span><span id="line-492"></span><span>    </span><span class="annot"><a href="#local-6989586621679077767"><span class="hs-identifier hs-var">pcvel'</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PosExtension
</span><a href="APRS.Types.html#PosENone"><span class="hs-identifier hs-var">PosENone</span></a></span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="annot"><a href="APRS.Types.html#parsePosUncompressed"><span class="hs-identifier hs-type">parsePosUncompressed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Symbol"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span id="parsePosUncompressed"><span class="annot"><span class="annottext">parsePosUncompressed :: Parser (Symbol, Position)
</span><a href="APRS.Types.html#parsePosUncompressed"><span class="hs-identifier hs-var hs-var">parsePosUncompressed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-497"></span><span>  </span><span id="local-6989586621679077759"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077759"><span class="hs-identifier hs-var">lat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Double
</span><a href="#local-6989586621679077758"><span class="hs-identifier hs-var">parseDir</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-498"></span><span>  </span><span id="local-6989586621679077757"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077757"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Char -&gt; Bool
</span><span class="hs-identifier hs-var">A.inClass</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0-9/\\A-Za-j&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>  </span><span id="local-6989586621679077756"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077756"><span class="hs-identifier hs-var">lon</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Double
</span><a href="#local-6989586621679077758"><span class="hs-identifier hs-var">parseDir</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-500"></span><span>  </span><span id="local-6989586621679077755"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077755"><span class="hs-identifier hs-var">sym</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.anyChar</span></span><span>
</span><span id="line-501"></span><span>  </span><span id="local-6989586621679077754"><span class="annot"><span class="annottext">PosExtension
</span><a href="#local-6989586621679077754"><span class="hs-identifier hs-var">posE</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser PosExtension
</span><a href="APRS.Types.html#parsePosExtension"><span class="hs-identifier hs-var">parsePosExtension</span></a></span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span>  </span><span class="hs-comment">-- TODO:  Altitude</span><span>
</span><span id="line-504"></span><span>  </span><span class="annot"><span class="annottext">(Symbol, Position) -&gt; Parser (Symbol, Position)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Symbol
</span><a href="APRS.Types.html#Symbol"><span class="hs-identifier hs-var">Symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077757"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077755"><span class="hs-identifier hs-var">sym</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Double, Double, Double, PosExtension) -&gt; Position
</span><a href="APRS.Types.html#Position"><span class="hs-identifier hs-var">Position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077759"><span class="hs-identifier hs-var">lat</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077756"><span class="hs-identifier hs-var">lon</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PosExtension
</span><a href="#local-6989586621679077754"><span class="hs-identifier hs-var">posE</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-507"></span><span>    </span><span class="annot"><a href="#local-6989586621679077758"><span class="hs-identifier hs-type">parseDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-508"></span><span>    </span><span id="local-6989586621679077758"><span class="annot"><span class="annottext">parseDir :: Int -&gt; Parser Double
</span><a href="#local-6989586621679077758"><span class="hs-identifier hs-var hs-var">parseDir</span></a></span></span><span> </span><span id="local-6989586621679077753"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077753"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-509"></span><span>      </span><span id="local-6989586621679077752"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077752"><span class="hs-identifier hs-var">cM</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077753"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.digit</span></span><span>
</span><span id="line-510"></span><span>      </span><span id="local-6989586621679077751"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077751"><span class="hs-identifier hs-var">cm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">A.many'</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.digit</span></span><span>
</span><span id="line-511"></span><span>      </span><span id="local-6989586621679077749"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077749"><span class="hs-identifier hs-var">cs1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">A.many'</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.space</span></span><span>
</span><span id="line-512"></span><span>      </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span>
</span><span id="line-513"></span><span>      </span><span id="local-6989586621679077747"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077747"><span class="hs-identifier hs-var">cd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">A.many'</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.digit</span></span><span>
</span><span id="line-514"></span><span>      </span><span id="local-6989586621679077746"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077746"><span class="hs-identifier hs-var">cs2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">A.many'</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.space</span></span><span>
</span><span id="line-515"></span><span>      </span><span id="local-6989586621679077745"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077745"><span class="hs-identifier hs-var">cdir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'N'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'S'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'E'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'W'</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077744"><span class="annot"><span class="annottext">amb :: Int
</span><a href="#local-6989586621679077744"><span class="hs-identifier hs-var hs-var">amb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">Prelude.length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077749"><span class="hs-identifier hs-var">cs1</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">Prelude.length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077746"><span class="hs-identifier hs-var">cs2</span></a></span><span>
</span><span id="line-518"></span><span>      </span><span class="annot"><span class="annottext">Double -&gt; Parser Double
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Parser Double) -&gt; Double -&gt; Parser Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; Double
</span><a href="#local-6989586621679077743"><span class="hs-identifier hs-var">compPos</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077752"><span class="hs-identifier hs-var">cM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077751"><span class="hs-identifier hs-var">cm</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077749"><span class="hs-identifier hs-var">cs1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077747"><span class="hs-identifier hs-var">cd</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077746"><span class="hs-identifier hs-var">cs2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><a href="APRS.Types.html#posamb"><span class="hs-identifier hs-var">posamb</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077744"><span class="hs-identifier hs-var">amb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Double
forall p. Num p =&gt; Char -&gt; p
</span><a href="#local-6989586621679077742"><span class="hs-identifier hs-var">psign</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077745"><span class="hs-identifier hs-var">cdir</span></a></span><span>
</span><span id="line-519"></span><span>
</span><span id="line-520"></span><span>    </span><span id="local-6989586621679077742"><span class="annot"><span class="annottext">psign :: Char -&gt; p
</span><a href="#local-6989586621679077742"><span class="hs-identifier hs-var hs-var">psign</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'S'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">p
</span><span class="hs-number">1</span></span><span>
</span><span id="line-521"></span><span>    </span><span class="annot"><a href="#local-6989586621679077742"><span class="hs-identifier hs-var">psign</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'W'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">p
</span><span class="hs-number">1</span></span><span>
</span><span id="line-522"></span><span>    </span><span class="annot"><a href="#local-6989586621679077742"><span class="hs-identifier hs-var">psign</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">1</span></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span>    </span><span class="annot"><a href="#local-6989586621679077743"><span class="hs-identifier hs-type">compPos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-525"></span><span>    </span><span id="local-6989586621679077743"><span class="annot"><span class="annottext">compPos :: String -&gt; String -&gt; String -&gt; Double
</span><a href="#local-6989586621679077743"><span class="hs-identifier hs-var hs-var">compPos</span></a></span></span><span> </span><span id="local-6989586621679077741"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077741"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679077740"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077740"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679077739"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077739"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077738"><span class="annot"><span class="annottext">a' :: Double
</span><a href="#local-6989586621679077738"><span class="hs-identifier hs-var hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Double
</span><a href="#local-6989586621679077737"><span class="hs-identifier hs-var">rz</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Double) -&gt; ([String] -&gt; String) -&gt; [String] -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">Prelude.concat</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679077735"><span class="hs-identifier hs-var">replspc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077741"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-526"></span><span>                        </span><span id="local-6989586621679077734"><span class="annot"><span class="annottext">b' :: Double
</span><a href="#local-6989586621679077734"><span class="hs-identifier hs-var hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Double
</span><a href="#local-6989586621679077737"><span class="hs-identifier hs-var">rz</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Double) -&gt; ([String] -&gt; String) -&gt; [String] -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">Prelude.concat</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679077735"><span class="hs-identifier hs-var">replspc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077740"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679077735"><span class="hs-identifier hs-var">replspc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077739"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-527"></span><span>                    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077738"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077734"><span class="hs-identifier hs-var">b'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">60</span></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>    </span><span id="local-6989586621679077735"><span class="annot"><span class="annottext">replspc :: ShowS
</span><a href="#local-6989586621679077735"><span class="hs-identifier hs-var hs-var">replspc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Char) -&gt; ShowS
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679077733"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077733"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077733"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077733"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>    </span><span id="local-6989586621679077737"><span class="annot"><span class="annottext">rz :: String -&gt; Double
</span><a href="#local-6989586621679077737"><span class="hs-identifier hs-var hs-var">rz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Double
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-comment">{-
Note: There is one exception to the requirement for the Data Type Identifier
to be the first character in the Information field &#8212; this is the Position without
Timestamp (indicated by the ! DTI). The ! character may occur anywhere
up to and including the 40th character position in the Information field. This
variability is required to support X1J TNC digipeaters which have a string of
unmodifiable text at the beginning of the field.
-}</span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span class="annot"><a href="APRS.Types.html#parsePositionPacket"><span class="hs-identifier hs-type">parsePositionPacket</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-type">APRSPacket</span></a></span><span>
</span><span id="line-542"></span><span id="parsePositionPacket"><span class="annot"><span class="annottext">parsePositionPacket :: Parser APRSPacket
</span><a href="APRS.Types.html#parsePositionPacket"><span class="hs-identifier hs-var hs-var">parsePositionPacket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-543"></span><span>  </span><span id="local-6989586621679077732"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077732"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'!'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'@'</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Text Char -&gt; Parser Text Char -&gt; Parser Text Char
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><a href="#local-6989586621679077731"><span class="hs-identifier hs-var">bangjunk</span></a></span><span>
</span><span id="line-544"></span><span>  </span><span id="local-6989586621679077730"><span class="annot"><span class="annottext">Maybe Timestamp
</span><a href="#local-6989586621679077730"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser (Maybe Timestamp)
</span><a href="#local-6989586621679077729"><span class="hs-identifier hs-var">maybeTS</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077732"><span class="hs-identifier hs-var">pre</span></a></span><span>
</span><span id="line-545"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679077728"><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679077728"><span class="hs-identifier hs-var">sym</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077727"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679077727"><span class="hs-identifier hs-var">pos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser (Symbol, Position)
</span><a href="APRS.Types.html#parsePosition"><span class="hs-identifier hs-var">parsePosition</span></a></span><span>
</span><span id="line-546"></span><span>  </span><span class="annot"><span class="annottext">PacketType
-&gt; Symbol -&gt; Position -&gt; Maybe Timestamp -&gt; Text -&gt; APRSPacket
</span><a href="APRS.Types.html#PositionPacket"><span class="hs-identifier hs-var">PositionPacket</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; PacketType
</span><a href="APRS.Types.html#identifyPacket"><span class="hs-identifier hs-var">identifyPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077732"><span class="hs-identifier hs-var">pre</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679077728"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679077727"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp
</span><a href="#local-6989586621679077730"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; APRSPacket) -&gt; Parser Text -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-identifier hs-var">A.takeText</span></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-549"></span><span>    </span><span class="annot"><a href="#local-6989586621679077729"><span class="hs-identifier hs-type">maybeTS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Timestamp"><span class="hs-identifier hs-type">Timestamp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>    </span><span id="local-6989586621679077729"><span class="annot"><span class="annottext">maybeTS :: Char -&gt; Parser (Maybe Timestamp)
</span><a href="#local-6989586621679077729"><span class="hs-identifier hs-var hs-var">maybeTS</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'!'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp -&gt; Parser (Maybe Timestamp)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-551"></span><span>    </span><span class="annot"><a href="#local-6989586621679077729"><span class="hs-identifier hs-var">maybeTS</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp -&gt; Parser (Maybe Timestamp)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-552"></span><span>    </span><span class="annot"><a href="#local-6989586621679077729"><span class="hs-identifier hs-var">maybeTS</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Timestamp -&gt; Maybe Timestamp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Timestamp -&gt; Maybe Timestamp)
-&gt; Parser Timestamp -&gt; Parser (Maybe Timestamp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Timestamp
</span><a href="APRS.Types.html#parseTimestamp"><span class="hs-identifier hs-var">parseTimestamp</span></a></span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><a href="#local-6989586621679077731"><span class="hs-identifier hs-type">bangjunk</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-555"></span><span>    </span><span id="local-6989586621679077731"><span class="annot"><span class="annottext">bangjunk :: Parser Text Char
</span><a href="#local-6989586621679077731"><span class="hs-identifier hs-var hs-var">bangjunk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-556"></span><span>      </span><span id="local-6989586621679077726"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077726"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text
</span><span class="hs-identifier hs-var">A.takeTill</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'!'</span></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Parser Text ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Parser Text ()) -&gt; Bool -&gt; Parser Text ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">Data.Text.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077726"><span class="hs-identifier hs-var">pre</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">40</span></span><span>
</span><span id="line-558"></span><span>      </span><span class="annot"><span class="annottext">Char -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'!'</span></span><span>
</span><span id="line-559"></span><span>
</span><span id="line-560"></span><span class="hs-keyword">data</span><span> </span><span id="ObjectState"><span class="annot"><a href="APRS.Types.html#ObjectState"><span class="hs-identifier hs-var">ObjectState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Live"><span class="annot"><a href="APRS.Types.html#Live"><span class="hs-identifier hs-var">Live</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Killed"><span class="annot"><a href="APRS.Types.html#Killed"><span class="hs-identifier hs-var">Killed</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077718"><span id="local-6989586621679077720"><span id="local-6989586621679077722"><span class="annot"><span class="annottext">Int -&gt; ObjectState -&gt; ShowS
[ObjectState] -&gt; ShowS
ObjectState -&gt; String
(Int -&gt; ObjectState -&gt; ShowS)
-&gt; (ObjectState -&gt; String)
-&gt; ([ObjectState] -&gt; ShowS)
-&gt; Show ObjectState
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ObjectState] -&gt; ShowS
$cshowList :: [ObjectState] -&gt; ShowS
show :: ObjectState -&gt; String
$cshow :: ObjectState -&gt; String
showsPrec :: Int -&gt; ObjectState -&gt; ShowS
$cshowsPrec :: Int -&gt; ObjectState -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077702"><span id="local-6989586621679077704"><span id="local-6989586621679077706"><span id="local-6989586621679077708"><span id="local-6989586621679077710"><span id="local-6989586621679077712"><span id="local-6989586621679077714"><span id="local-6989586621679077716"><span class="annot"><span class="annottext">Int -&gt; ObjectState
ObjectState -&gt; Int
ObjectState -&gt; [ObjectState]
ObjectState -&gt; ObjectState
ObjectState -&gt; ObjectState -&gt; [ObjectState]
ObjectState -&gt; ObjectState -&gt; ObjectState -&gt; [ObjectState]
(ObjectState -&gt; ObjectState)
-&gt; (ObjectState -&gt; ObjectState)
-&gt; (Int -&gt; ObjectState)
-&gt; (ObjectState -&gt; Int)
-&gt; (ObjectState -&gt; [ObjectState])
-&gt; (ObjectState -&gt; ObjectState -&gt; [ObjectState])
-&gt; (ObjectState -&gt; ObjectState -&gt; [ObjectState])
-&gt; (ObjectState -&gt; ObjectState -&gt; ObjectState -&gt; [ObjectState])
-&gt; Enum ObjectState
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
enumFromThenTo :: ObjectState -&gt; ObjectState -&gt; ObjectState -&gt; [ObjectState]
$cenumFromThenTo :: ObjectState -&gt; ObjectState -&gt; ObjectState -&gt; [ObjectState]
enumFromTo :: ObjectState -&gt; ObjectState -&gt; [ObjectState]
$cenumFromTo :: ObjectState -&gt; ObjectState -&gt; [ObjectState]
enumFromThen :: ObjectState -&gt; ObjectState -&gt; [ObjectState]
$cenumFromThen :: ObjectState -&gt; ObjectState -&gt; [ObjectState]
enumFrom :: ObjectState -&gt; [ObjectState]
$cenumFrom :: ObjectState -&gt; [ObjectState]
fromEnum :: ObjectState -&gt; Int
$cfromEnum :: ObjectState -&gt; Int
toEnum :: Int -&gt; ObjectState
$ctoEnum :: Int -&gt; ObjectState
pred :: ObjectState -&gt; ObjectState
$cpred :: ObjectState -&gt; ObjectState
succ :: ObjectState -&gt; ObjectState
$csucc :: ObjectState -&gt; ObjectState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077698"><span id="local-6989586621679077700"><span class="annot"><span class="annottext">ObjectState
ObjectState -&gt; ObjectState -&gt; Bounded ObjectState
forall a. a -&gt; a -&gt; Bounded a
maxBound :: ObjectState
$cmaxBound :: ObjectState
minBound :: ObjectState
$cminBound :: ObjectState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077694"><span id="local-6989586621679077696"><span class="annot"><span class="annottext">ObjectState -&gt; ObjectState -&gt; Bool
(ObjectState -&gt; ObjectState -&gt; Bool)
-&gt; (ObjectState -&gt; ObjectState -&gt; Bool) -&gt; Eq ObjectState
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ObjectState -&gt; ObjectState -&gt; Bool
$c/= :: ObjectState -&gt; ObjectState -&gt; Bool
== :: ObjectState -&gt; ObjectState -&gt; Bool
$c== :: ObjectState -&gt; ObjectState -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="annot"><a href="APRS.Types.html#objState"><span class="hs-identifier hs-type">objState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="APRS.Types.html#ObjectState"><span class="hs-identifier hs-type">ObjectState</span></a></span><span>
</span><span id="line-563"></span><span id="objState"><span class="annot"><span class="annottext">objState :: Char -&gt; ObjectState
</span><a href="APRS.Types.html#objState"><span class="hs-identifier hs-var hs-var">objState</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ObjectState
</span><a href="APRS.Types.html#Killed"><span class="hs-identifier hs-var">Killed</span></a></span><span>
</span><span id="line-564"></span><span class="annot"><a href="APRS.Types.html#objState"><span class="hs-identifier hs-var">objState</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ObjectState
</span><a href="APRS.Types.html#Live"><span class="hs-identifier hs-var">Live</span></a></span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span class="annot"><a href="APRS.Types.html#parseObjectPacket"><span class="hs-identifier hs-type">parseObjectPacket</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-type">APRSPacket</span></a></span><span>
</span><span id="line-567"></span><span id="parseObjectPacket"><span class="annot"><span class="annottext">parseObjectPacket :: Parser APRSPacket
</span><a href="APRS.Types.html#parseObjectPacket"><span class="hs-identifier hs-var hs-var">parseObjectPacket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-568"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">';'</span></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>  </span><span id="local-6989586621679077692"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077692"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.anyChar</span></span><span>
</span><span id="line-570"></span><span>  </span><span id="local-6989586621679077691"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077691"><span class="hs-identifier hs-var">ost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'*'</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- killed, live</span><span>
</span><span id="line-571"></span><span>  </span><span id="local-6989586621679077690"><span class="annot"><span class="annottext">Timestamp
</span><a href="#local-6989586621679077690"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Timestamp
</span><a href="APRS.Types.html#parseTimestamp"><span class="hs-identifier hs-var">parseTimestamp</span></a></span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679077689"><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679077689"><span class="hs-identifier hs-var">sym</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077688"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077688"><span class="hs-identifier hs-var">lat</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077687"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077687"><span class="hs-identifier hs-var">lon</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077686"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077686"><span class="hs-identifier hs-var">alt</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PosExtension
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser (Symbol, Position)
</span><a href="APRS.Types.html#parsePosition"><span class="hs-identifier hs-var">parsePosition</span></a></span><span>
</span><span id="line-573"></span><span>  </span><span id="local-6989586621679077685"><span class="annot"><span class="annottext">ObjectData
</span><a href="#local-6989586621679077685"><span class="hs-identifier hs-var">objdat</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser ObjectData
</span><a href="#local-6989586621679077684"><span class="hs-identifier hs-var">parseObjData</span></a></span><span>
</span><span id="line-574"></span><span>  </span><span class="annot"><span class="annottext">APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(APRSPacket -&gt; Parser APRSPacket)
-&gt; APRSPacket -&gt; Parser APRSPacket
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Symbol
-&gt; ObjectState
-&gt; Text
-&gt; Position
-&gt; Timestamp
-&gt; ObjectData
-&gt; APRSPacket
</span><a href="APRS.Types.html#ObjectPacket"><span class="hs-identifier hs-var">ObjectPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679077689"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ObjectState
</span><a href="APRS.Types.html#objState"><span class="hs-identifier hs-var">objState</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077691"><span class="hs-identifier hs-var">ost</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
forall a. IsString a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077692"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double, Double, PosExtension) -&gt; Position
</span><a href="APRS.Types.html#Position"><span class="hs-identifier hs-var">Position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077688"><span class="hs-identifier hs-var">lat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077687"><span class="hs-identifier hs-var">lon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077686"><span class="hs-identifier hs-var">alt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PosExtension
</span><a href="APRS.Types.html#PosENone"><span class="hs-identifier hs-var">PosENone</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Timestamp
</span><a href="#local-6989586621679077690"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="annot"><span class="annottext">ObjectData
</span><a href="#local-6989586621679077685"><span class="hs-identifier hs-var">objdat</span></a></span><span>
</span><span id="line-575"></span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-577"></span><span>    </span><span class="annot"><a href="#local-6989586621679077684"><span class="hs-identifier hs-type">parseObjData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#ObjectData"><span class="hs-identifier hs-type">ObjectData</span></a></span><span>
</span><span id="line-578"></span><span>    </span><span id="local-6989586621679077684"><span class="annot"><span class="annottext">parseObjData :: Parser ObjectData
</span><a href="#local-6989586621679077684"><span class="hs-identifier hs-var hs-var">parseObjData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WeatherParam] -&gt; ObjectData
</span><a href="APRS.Types.html#ObjWeather"><span class="hs-identifier hs-var">ObjWeather</span></a></span><span> </span><span class="annot"><span class="annottext">([WeatherParam] -&gt; ObjectData)
-&gt; Parser [WeatherParam] -&gt; Parser ObjectData
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser [WeatherParam]
</span><a href="APRS.Types.html#parseWeather"><span class="hs-identifier hs-var">parseWeather</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser ObjectData -&gt; Parser ObjectData -&gt; Parser ObjectData
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ObjectData
</span><a href="APRS.Types.html#ObjText"><span class="hs-identifier hs-var">ObjText</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; ObjectData) -&gt; Parser Text -&gt; Parser ObjectData
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-identifier hs-var">A.takeText</span></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span class="annot"><a href="APRS.Types.html#parseItemPacket"><span class="hs-identifier hs-type">parseItemPacket</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-type">APRSPacket</span></a></span><span>
</span><span id="line-581"></span><span id="parseItemPacket"><span class="annot"><span class="annottext">parseItemPacket :: Parser APRSPacket
</span><a href="APRS.Types.html#parseItemPacket"><span class="hs-identifier hs-var hs-var">parseItemPacket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-582"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">')'</span></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>  </span><span id="local-6989586621679077683"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077683"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text
</span><span class="hs-identifier hs-var">A.takeTill</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679077682"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077682"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077682"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077682"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'!'</span></span><span class="hs-special">)</span><span>
</span><span id="line-584"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Parser Text ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Parser Text ()) -&gt; Bool -&gt; Parser Text ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">Data.Text.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077683"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">Data.Text.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077683"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span>
</span><span id="line-585"></span><span>  </span><span id="local-6989586621679077680"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077680"><span class="hs-identifier hs-var">ost</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'!'</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- killed, live</span><span>
</span><span id="line-586"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679077679"><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679077679"><span class="hs-identifier hs-var">sym</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077678"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077678"><span class="hs-identifier hs-var">lat</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077677"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077677"><span class="hs-identifier hs-var">lon</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077676"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077676"><span class="hs-identifier hs-var">alt</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PosExtension
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser (Symbol, Position)
</span><a href="APRS.Types.html#parsePosition"><span class="hs-identifier hs-var">parsePosition</span></a></span><span>
</span><span id="line-587"></span><span>  </span><span class="annot"><span class="annottext">Symbol -&gt; ObjectState -&gt; Text -&gt; Position -&gt; Text -&gt; APRSPacket
</span><a href="APRS.Types.html#ItemPacket"><span class="hs-identifier hs-var">ItemPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Symbol
</span><a href="#local-6989586621679077679"><span class="hs-identifier hs-var">sym</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; ObjectState
</span><a href="APRS.Types.html#objState"><span class="hs-identifier hs-var">objState</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077680"><span class="hs-identifier hs-var">ost</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077683"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double, Double, PosExtension) -&gt; Position
</span><a href="APRS.Types.html#Position"><span class="hs-identifier hs-var">Position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077678"><span class="hs-identifier hs-var">lat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077677"><span class="hs-identifier hs-var">lon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077676"><span class="hs-identifier hs-var">alt</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">PosExtension
</span><a href="APRS.Types.html#PosENone"><span class="hs-identifier hs-var">PosENone</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; APRSPacket) -&gt; Parser Text -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-identifier hs-var">A.takeText</span></span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="annot"><a href="APRS.Types.html#parseWeatherPacket"><span class="hs-identifier hs-type">parseWeatherPacket</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-type">APRSPacket</span></a></span><span>
</span><span id="line-590"></span><span id="parseWeatherPacket"><span class="annot"><span class="annottext">parseWeatherPacket :: Parser APRSPacket
</span><a href="APRS.Types.html#parseWeatherPacket"><span class="hs-identifier hs-var hs-var">parseWeatherPacket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser APRSPacket
</span><a href="APRS.Types.html#parseUltimeter"><span class="hs-identifier hs-var">parseUltimeter</span></a></span><span> </span><span class="annot"><span class="annottext">Parser APRSPacket -&gt; Parser APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser APRSPacket
</span><a href="APRS.Types.html#parseStandardWeather"><span class="hs-identifier hs-var">parseStandardWeather</span></a></span><span>
</span><span id="line-591"></span><span>
</span><span id="line-592"></span><span class="hs-comment">{-
1. Wind Speed (0.1 kph)
2. Wind Direction (0-255)
3. Outdoor Temp (0.1 deg F)
4. Rain* Long Term Total (0.01 inches)
5. Barometer (0.1 mbar)
6. Indoor Temp (0.1 deg F)
7. Outdoor Humidity (0.1%)
8. Indoor Humidity (0.1%)
9. Date (day of year)     -- TODO
10. Time (minute of day)  -- TODO
11. Today's Rain Total (0.01 inches)*
12. 1 Minute Wind Speed Average (0.1kph)*
-}</span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span>
</span><span id="line-608"></span><span class="hs-comment">-- This is data logger mode.  There's also a || for packet mode.  See</span><span>
</span><span id="line-609"></span><span class="hs-comment">-- http://www.peetbros.com/shop/custom.aspx?recid=29</span><span>
</span><span id="line-610"></span><span class="hs-comment">-- TODO:  Ensure consistent units</span><span>
</span><span id="line-611"></span><span class="annot"><a href="APRS.Types.html#parseUltimeter"><span class="hs-identifier hs-type">parseUltimeter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-type">APRSPacket</span></a></span><span>
</span><span id="line-612"></span><span id="parseUltimeter"><span class="annot"><span class="annottext">parseUltimeter :: Parser APRSPacket
</span><a href="APRS.Types.html#parseUltimeter"><span class="hs-identifier hs-var hs-var">parseUltimeter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-613"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077673"><span class="annot"><span class="annottext">funsl :: [Int -&gt; Maybe WeatherParam]
</span><a href="#local-6989586621679077673"><span class="hs-identifier hs-var hs-var">funsl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">WeatherParam -&gt; Maybe WeatherParam
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="annot"><span class="annottext">(WeatherParam -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; WeatherParam) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#WindSpeed"><span class="hs-identifier hs-var">WindSpeed</span></a></span><span class="annot"><span class="annottext">(Int -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; Int) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WeatherParam -&gt; Maybe WeatherParam
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="annot"><span class="annottext">(WeatherParam -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; WeatherParam) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#WindDir"><span class="hs-identifier hs-var">WindDir</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WeatherParam -&gt; Maybe WeatherParam
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="annot"><span class="annottext">(WeatherParam -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; WeatherParam) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="#local-6989586621679077671"><span class="hs-identifier hs-var">convertTemp</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WeatherParam -&gt; Maybe WeatherParam
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="annot"><span class="annottext">(WeatherParam -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; WeatherParam) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#RainLast24Hours"><span class="hs-identifier hs-var">RainLast24Hours</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-614"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WeatherParam -&gt; Maybe WeatherParam
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="annot"><span class="annottext">(WeatherParam -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; WeatherParam) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#Baro"><span class="hs-identifier hs-var">Baro</span></a></span><span class="annot"><span class="annottext">(Int -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; Int) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe WeatherParam
forall b a. b -&gt; Maybe a
</span><a href="#local-6989586621679077670"><span class="hs-identifier hs-var">ignore</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WeatherParam -&gt; Maybe WeatherParam
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="annot"><span class="annottext">(WeatherParam -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; WeatherParam) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#Humidity"><span class="hs-identifier hs-var">Humidity</span></a></span><span class="annot"><span class="annottext">(Int -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; Int) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe WeatherParam
forall b a. b -&gt; Maybe a
</span><a href="#local-6989586621679077670"><span class="hs-identifier hs-var">ignore</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe WeatherParam
forall b a. b -&gt; Maybe a
</span><a href="#local-6989586621679077670"><span class="hs-identifier hs-var">ignore</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe WeatherParam
forall b a. b -&gt; Maybe a
</span><a href="#local-6989586621679077670"><span class="hs-identifier hs-var">ignore</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-615"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WeatherParam -&gt; Maybe WeatherParam
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="annot"><span class="annottext">(WeatherParam -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; WeatherParam) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#RainToday"><span class="hs-identifier hs-var">RainToday</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe WeatherParam
forall b a. b -&gt; Maybe a
</span><a href="#local-6989586621679077670"><span class="hs-identifier hs-var">ignore</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-616"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077669"><span class="annot"><span class="annottext">funsp :: [Int -&gt; Maybe WeatherParam]
</span><a href="#local-6989586621679077669"><span class="hs-identifier hs-var hs-var">funsp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">WeatherParam -&gt; Maybe WeatherParam
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="annot"><span class="annottext">(WeatherParam -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; WeatherParam) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#WindSpeed"><span class="hs-identifier hs-var">WindSpeed</span></a></span><span class="annot"><span class="annottext">(Int -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; Int) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WeatherParam -&gt; Maybe WeatherParam
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="annot"><span class="annottext">(WeatherParam -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; WeatherParam) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#WindDir"><span class="hs-identifier hs-var">WindDir</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WeatherParam -&gt; Maybe WeatherParam
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="annot"><span class="annottext">(WeatherParam -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; WeatherParam) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="#local-6989586621679077671"><span class="hs-identifier hs-var">convertTemp</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WeatherParam -&gt; Maybe WeatherParam
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="annot"><span class="annottext">(WeatherParam -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; WeatherParam) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#RainLast24Hours"><span class="hs-identifier hs-var">RainLast24Hours</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-617"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WeatherParam -&gt; Maybe WeatherParam
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="annot"><span class="annottext">(WeatherParam -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; WeatherParam) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#Baro"><span class="hs-identifier hs-var">Baro</span></a></span><span class="annot"><span class="annottext">(Int -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; Int) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe WeatherParam
forall b a. b -&gt; Maybe a
</span><a href="#local-6989586621679077670"><span class="hs-identifier hs-var">ignore</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe WeatherParam
forall b a. b -&gt; Maybe a
</span><a href="#local-6989586621679077670"><span class="hs-identifier hs-var">ignore</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe WeatherParam
forall b a. b -&gt; Maybe a
</span><a href="#local-6989586621679077670"><span class="hs-identifier hs-var">ignore</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WeatherParam -&gt; Maybe WeatherParam
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="annot"><span class="annottext">(WeatherParam -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; WeatherParam) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#Humidity"><span class="hs-identifier hs-var">Humidity</span></a></span><span class="annot"><span class="annottext">(Int -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; Int) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe WeatherParam
forall b a. b -&gt; Maybe a
</span><a href="#local-6989586621679077670"><span class="hs-identifier hs-var">ignore</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe WeatherParam
forall b a. b -&gt; Maybe a
</span><a href="#local-6989586621679077670"><span class="hs-identifier hs-var">ignore</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-618"></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WeatherParam -&gt; Maybe WeatherParam
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="annot"><span class="annottext">(WeatherParam -&gt; Maybe WeatherParam)
-&gt; (Int -&gt; WeatherParam) -&gt; Int -&gt; Maybe WeatherParam
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#RainToday"><span class="hs-identifier hs-var">RainToday</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span>  </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;!!&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Int -&gt; Maybe WeatherParam] -&gt; Parser APRSPacket
</span><a href="#local-6989586621679077668"><span class="hs-identifier hs-var">ulti</span></a></span><span> </span><span class="annot"><span class="annottext">[Int -&gt; Maybe WeatherParam]
</span><a href="#local-6989586621679077673"><span class="hs-identifier hs-var">funsl</span></a></span><span> </span><span class="annot"><span class="annottext">Parser APRSPacket -&gt; Parser APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;$ULTW&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Int -&gt; Maybe WeatherParam] -&gt; Parser APRSPacket
</span><a href="#local-6989586621679077668"><span class="hs-identifier hs-var">ulti</span></a></span><span> </span><span class="annot"><span class="annottext">[Int -&gt; Maybe WeatherParam]
</span><a href="#local-6989586621679077669"><span class="hs-identifier hs-var">funsp</span></a></span><span>
</span><span id="line-621"></span><span>
</span><span id="line-622"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-623"></span><span>    </span><span class="annot"><a href="#local-6989586621679077668"><span class="hs-identifier hs-type">ulti</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="APRS.Types.html#WeatherParam"><span class="hs-identifier hs-type">WeatherParam</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-type">APRSPacket</span></a></span><span>
</span><span id="line-624"></span><span>    </span><span id="local-6989586621679077668"><span class="annot"><span class="annottext">ulti :: [Int -&gt; Maybe WeatherParam] -&gt; Parser APRSPacket
</span><a href="#local-6989586621679077668"><span class="hs-identifier hs-var hs-var">ulti</span></a></span></span><span> </span><span id="local-6989586621679077667"><span class="annot"><span class="annottext">[Int -&gt; Maybe WeatherParam]
</span><a href="#local-6989586621679077667"><span class="hs-identifier hs-var">funs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-625"></span><span>      </span><span id="local-6989586621679077666"><span class="annot"><span class="annottext">[Maybe Int]
</span><a href="#local-6989586621679077666"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text [Maybe Int]
</span><a href="#local-6989586621679077665"><span class="hs-identifier hs-var">vals</span></a></span><span>
</span><span id="line-626"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077664"><span class="annot"><span class="annottext">params :: [Maybe WeatherParam]
</span><a href="#local-6989586621679077664"><span class="hs-identifier hs-var hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int -&gt; Maybe WeatherParam) -&gt; Maybe Int -&gt; Maybe WeatherParam)
-&gt; [Int -&gt; Maybe WeatherParam]
-&gt; [Maybe Int]
-&gt; [Maybe WeatherParam]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Maybe WeatherParam) -&gt; Maybe Int -&gt; Maybe WeatherParam
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">(=&lt;&lt;)</span></span><span> </span><span class="annot"><span class="annottext">[Int -&gt; Maybe WeatherParam]
</span><a href="#local-6989586621679077667"><span class="hs-identifier hs-var">funs</span></a></span><span> </span><span class="annot"><span class="annottext">[Maybe Int]
</span><a href="#local-6989586621679077666"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-627"></span><span>      </span><span class="annot"><span class="annottext">APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(APRSPacket -&gt; Parser APRSPacket)
-&gt; APRSPacket -&gt; Parser APRSPacket
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp
-&gt; Maybe Position
-&gt; [WeatherParam]
-&gt; WeatherSW
-&gt; WeatherUnit
-&gt; Text
-&gt; APRSPacket
</span><a href="APRS.Types.html#WeatherPacket"><span class="hs-identifier hs-var">WeatherPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe Position
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Maybe WeatherParam] -&gt; [WeatherParam]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">[Maybe WeatherParam]
</span><a href="#local-6989586621679077664"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; WeatherSW
</span><a href="APRS.Types.html#UnknownWeatherSW"><span class="hs-identifier hs-var">UnknownWeatherSW</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'?'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WeatherUnit
</span><a href="APRS.Types.html#WUUltimeter2000"><span class="hs-identifier hs-var">WUUltimeter2000</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span>    </span><span id="local-6989586621679077665"><span class="annot"><span class="annottext">vals :: Parser Text [Maybe Int]
</span><a href="#local-6989586621679077665"><span class="hs-identifier hs-var hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser Text (Maybe Int) -&gt; Parser Text [Maybe Int]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">A.many1</span></span><span> </span><span class="annot"><span class="annottext">(Parser Text (Maybe Int) -&gt; Parser Text [Maybe Int])
-&gt; Parser Text (Maybe Int) -&gt; Parser Text [Maybe Int]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-630"></span><span>      </span><span id="local-6989586621679077661"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077661"><span class="hs-identifier hs-var">digs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="annot"><span class="annottext">((Char -&gt; Bool) -&gt; Parser Text Char)
-&gt; (Char -&gt; Bool) -&gt; Parser Text Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Char -&gt; Bool
</span><span class="hs-identifier hs-var">A.inClass</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;A-F0-9-&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span>      </span><span class="annot"><span class="annottext">Maybe Int -&gt; Parser Text (Maybe Int)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Parser Text (Maybe Int))
-&gt; Maybe Int -&gt; Parser Text (Maybe Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Int
forall a. Read a =&gt; String -&gt; Maybe a
</span><span class="hs-identifier hs-var">readMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0x&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077661"><span class="hs-identifier hs-var">digs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span>
</span><span id="line-633"></span><span>    </span><span id="local-6989586621679077670"><span class="annot"><span class="annottext">ignore :: b -&gt; Maybe a
</span><a href="#local-6989586621679077670"><span class="hs-identifier hs-var hs-var">ignore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; b -&gt; Maybe a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span>    </span><span class="annot"><a href="#local-6989586621679077671"><span class="hs-identifier hs-type">convertTemp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="APRS.Types.html#WeatherParam"><span class="hs-identifier hs-type">WeatherParam</span></a></span><span>
</span><span id="line-636"></span><span>    </span><span id="local-6989586621679077671"><span class="annot"><span class="annottext">convertTemp :: Int -&gt; WeatherParam
</span><a href="#local-6989586621679077671"><span class="hs-identifier hs-var hs-var">convertTemp</span></a></span></span><span> </span><span id="local-6989586621679077659"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077659"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; WeatherParam
</span><a href="APRS.Types.html#Temp"><span class="hs-identifier hs-var">Temp</span></a></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; WeatherParam) -&gt; Double -&gt; WeatherParam
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><a href="APRS.Types.html#f2c"><span class="hs-identifier hs-var">f2c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077659"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10</span></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>
</span><span id="line-638"></span><span class="annot"><a href="APRS.Types.html#f2c"><span class="hs-identifier hs-type">f2c</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-639"></span><span id="f2c"><span class="annot"><span class="annottext">f2c :: Double -&gt; Double
</span><a href="APRS.Types.html#f2c"><span class="hs-identifier hs-var hs-var">f2c</span></a></span></span><span> </span><span id="local-6989586621679077658"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077658"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077658"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">32</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">9</span></span><span>
</span><span id="line-640"></span><span>
</span><span id="line-641"></span><span class="annot"><a href="APRS.Types.html#parseStandardWeather"><span class="hs-identifier hs-type">parseStandardWeather</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-type">APRSPacket</span></a></span><span>
</span><span id="line-642"></span><span id="parseStandardWeather"><span class="annot"><span class="annottext">parseStandardWeather :: Parser APRSPacket
</span><a href="APRS.Types.html#parseStandardWeather"><span class="hs-identifier hs-var hs-var">parseStandardWeather</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-643"></span><span>  </span><span id="local-6989586621679077657"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077657"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'!'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'@'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span>  </span><span id="local-6989586621679077656"><span class="annot"><span class="annottext">Maybe Timestamp
</span><a href="#local-6989586621679077656"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Timestamp -&gt; Maybe Timestamp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Timestamp -&gt; Maybe Timestamp)
-&gt; Parser Timestamp -&gt; Parser (Maybe Timestamp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Timestamp
</span><a href="APRS.Types.html#parseTimestamp"><span class="hs-identifier hs-var">parseTimestamp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser (Maybe Timestamp)
-&gt; Parser (Maybe Timestamp) -&gt; Parser (Maybe Timestamp)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp -&gt; Parser (Maybe Timestamp)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-645"></span><span>  </span><span id="local-6989586621679077655"><span class="annot"><span class="annottext">Maybe Position
</span><a href="#local-6989586621679077655"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077657"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'_'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Position -&gt; Parser Text (Maybe Position)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Position
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Parser Text (Maybe Position)
</span><a href="#local-6989586621679077654"><span class="hs-identifier hs-var">ppos</span></a></span><span>
</span><span id="line-646"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077653"><span class="annot"><span class="annottext">extra :: [WeatherParam]
</span><a href="#local-6989586621679077653"><span class="hs-identifier hs-var hs-var">extra</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Position
</span><a href="#local-6989586621679077655"><span class="hs-identifier hs-var">pos</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-647"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><a href="APRS.Types.html#PosECourseSpeed"><span class="hs-identifier hs-type">PosECourseSpeed</span></a></span><span> </span><span id="local-6989586621679077652"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077652"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679077651"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077651"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#WindDir"><span class="hs-identifier hs-var">WindDir</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077652"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#WindSpeed"><span class="hs-identifier hs-var">WindSpeed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Int) -&gt; Double -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077651"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.852</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-648"></span><span>                </span><span class="annot"><span class="annottext">Maybe Position
</span><span class="hs-identifier">_</span></span><span>                                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-649"></span><span>  </span><span id="local-6989586621679077649"><span class="annot"><span class="annottext">[WeatherParam]
</span><a href="#local-6989586621679077649"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [WeatherParam]
</span><a href="#local-6989586621679077648"><span class="hs-identifier hs-var">parsews</span></a></span><span> </span><span class="annot"><span class="annottext">Parser [WeatherParam]
-&gt; Parser [WeatherParam] -&gt; Parser [WeatherParam]
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">[WeatherParam] -&gt; Parser [WeatherParam]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-650"></span><span>  </span><span id="local-6989586621679077647"><span class="annot"><span class="annottext">[WeatherParam]
</span><a href="#local-6989586621679077647"><span class="hs-identifier hs-var">wp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser [WeatherParam]
</span><a href="APRS.Types.html#parseWeather"><span class="hs-identifier hs-var">parseWeather</span></a></span><span>
</span><span id="line-651"></span><span>  </span><span id="local-6989586621679077646"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077646"><span class="hs-identifier hs-var">swc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.anyChar</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Char -&gt; Parser Text Char -&gt; Parser Text Char
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Text Char
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'?'</span></span><span>
</span><span id="line-652"></span><span>  </span><span id="local-6989586621679077645"><span class="annot"><span class="annottext">WeatherUnit
</span><a href="#local-6989586621679077645"><span class="hs-keyword hs-var">unit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser WeatherUnit
</span><a href="APRS.Types.html#parseWeatherUnit"><span class="hs-identifier hs-var">parseWeatherUnit</span></a></span><span> </span><span class="annot"><span class="annottext">Parser WeatherUnit -&gt; Parser WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">WeatherUnit -&gt; Parser WeatherUnit
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; WeatherUnit
</span><a href="APRS.Types.html#UnknownWeatherUnit"><span class="hs-identifier hs-var">UnknownWeatherUnit</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;??&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>  </span><span class="annot"><span class="annottext">Maybe Timestamp
-&gt; Maybe Position
-&gt; [WeatherParam]
-&gt; WeatherSW
-&gt; WeatherUnit
-&gt; Text
-&gt; APRSPacket
</span><a href="APRS.Types.html#WeatherPacket"><span class="hs-identifier hs-var">WeatherPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp
</span><a href="#local-6989586621679077656"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Position -&gt; Maybe Position
</span><a href="#local-6989586621679077644"><span class="hs-identifier hs-var">pos'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Position
</span><a href="#local-6989586621679077655"><span class="hs-identifier hs-var">pos</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WeatherParam] -&gt; [WeatherParam]
</span><a href="#local-6989586621679077643"><span class="hs-identifier hs-var">mightsnow</span></a></span><span> </span><span class="annot"><span class="annottext">([WeatherParam] -&gt; [WeatherParam])
-&gt; [WeatherParam] -&gt; [WeatherParam]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[WeatherParam]
</span><a href="#local-6989586621679077653"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="annot"><span class="annottext">[WeatherParam] -&gt; [WeatherParam] -&gt; [WeatherParam]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[WeatherParam]
</span><a href="#local-6989586621679077649"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">[WeatherParam] -&gt; [WeatherParam] -&gt; [WeatherParam]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[WeatherParam]
</span><a href="#local-6989586621679077647"><span class="hs-identifier hs-var">wp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; WeatherSW
</span><a href="APRS.Types.html#lookupWeatherSW"><span class="hs-identifier hs-var">lookupWeatherSW</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077646"><span class="hs-identifier hs-var">swc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WeatherUnit
</span><a href="#local-6989586621679077645"><span class="hs-keyword hs-var">unit</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; APRSPacket) -&gt; Parser Text -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-identifier hs-var">A.takeText</span></span><span>
</span><span id="line-654"></span><span>
</span><span id="line-655"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-656"></span><span>    </span><span class="annot"><a href="#local-6989586621679077654"><span class="hs-identifier hs-type">ppos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>    </span><span id="local-6989586621679077654"><span class="annot"><span class="annottext">ppos :: Parser Text (Maybe Position)
</span><a href="#local-6989586621679077654"><span class="hs-identifier hs-var hs-var">ppos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parser (Symbol, Position)
</span><a href="APRS.Types.html#parsePosition"><span class="hs-identifier hs-var">parsePosition</span></a></span><span> </span><span class="annot"><span class="annottext">Parser (Symbol, Position)
-&gt; ((Symbol, Position) -&gt; Parser Text (Maybe Position))
-&gt; Parser Text (Maybe Position)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Symbol
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077642"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679077642"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Position -&gt; Parser Text (Maybe Position)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Position -&gt; Parser Text (Maybe Position))
-&gt; Maybe Position -&gt; Parser Text (Maybe Position)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Maybe Position
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679077642"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-658"></span><span>    </span><span id="local-6989586621679077644"><span class="annot"><span class="annottext">pos' :: Maybe Position -&gt; Maybe Position
</span><a href="#local-6989586621679077644"><span class="hs-identifier hs-var hs-var">pos'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Position
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Position
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-659"></span><span>    </span><span class="annot"><a href="#local-6989586621679077644"><span class="hs-identifier hs-var">pos'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Position"><span class="hs-identifier hs-type">Position</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077641"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077641"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077640"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077640"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077639"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077639"><span class="hs-identifier hs-var">alt</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PosExtension
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Maybe Position
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double, Double, PosExtension) -&gt; Position
</span><a href="APRS.Types.html#Position"><span class="hs-identifier hs-var">Position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077641"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077640"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077639"><span class="hs-identifier hs-var">alt</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PosExtension
</span><a href="APRS.Types.html#PosENone"><span class="hs-identifier hs-var">PosENone</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-660"></span><span>    </span><span id="local-6989586621679077648"><span class="annot"><span class="annottext">parsews :: Parser [WeatherParam]
</span><a href="#local-6989586621679077648"><span class="hs-identifier hs-var hs-var">parsews</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-661"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679077638"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077638"><span class="hs-identifier hs-var">crs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077637"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077637"><span class="hs-identifier hs-var">spd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser (Int, Double)
</span><a href="APRS.Types.html#parseCourseSpeed"><span class="hs-identifier hs-var">parseCourseSpeed</span></a></span><span>
</span><span id="line-662"></span><span>      </span><span class="annot"><span class="annottext">[WeatherParam] -&gt; Parser [WeatherParam]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#WindDir"><span class="hs-identifier hs-var">WindDir</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077638"><span class="hs-identifier hs-var">crs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#WindSpeed"><span class="hs-identifier hs-var">WindSpeed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077637"><span class="hs-identifier hs-var">spd</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-663"></span><span>    </span><span class="annot"><a href="#local-6989586621679077643"><span class="hs-identifier hs-type">mightsnow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="APRS.Types.html#WeatherParam"><span class="hs-identifier hs-type">WeatherParam</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="APRS.Types.html#WeatherParam"><span class="hs-identifier hs-type">WeatherParam</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-664"></span><span>    </span><span id="local-6989586621679077643"><span class="annot"><span class="annottext">mightsnow :: [WeatherParam] -&gt; [WeatherParam]
</span><a href="#local-6989586621679077643"><span class="hs-identifier hs-var hs-var">mightsnow</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-665"></span><span>    </span><span class="annot"><a href="#local-6989586621679077643"><span class="hs-identifier hs-var">mightsnow</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077636"><span class="annot"><span class="annottext">s :: WeatherParam
</span><a href="#local-6989586621679077636"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#WindSpeed"><span class="hs-identifier hs-type">WindSpeed</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077635"><span class="annot"><span class="annottext">[WeatherParam]
</span><a href="#local-6989586621679077635"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WeatherParam
</span><a href="#local-6989586621679077636"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">WeatherParam -&gt; [WeatherParam] -&gt; [WeatherParam]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[WeatherParam] -&gt; [WeatherParam]
</span><a href="#local-6989586621679077634"><span class="hs-identifier hs-var">sawRain</span></a></span><span> </span><span class="annot"><span class="annottext">[WeatherParam]
</span><a href="#local-6989586621679077635"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-666"></span><span>    </span><span class="annot"><a href="#local-6989586621679077643"><span class="hs-identifier hs-var">mightsnow</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077633"><span class="annot"><span class="annottext">WeatherParam
</span><a href="#local-6989586621679077633"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077632"><span class="annot"><span class="annottext">[WeatherParam]
</span><a href="#local-6989586621679077632"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WeatherParam
</span><a href="#local-6989586621679077633"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">WeatherParam -&gt; [WeatherParam] -&gt; [WeatherParam]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[WeatherParam] -&gt; [WeatherParam]
</span><a href="#local-6989586621679077643"><span class="hs-identifier hs-var">mightsnow</span></a></span><span> </span><span class="annot"><span class="annottext">[WeatherParam]
</span><a href="#local-6989586621679077632"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-667"></span><span>
</span><span id="line-668"></span><span>    </span><span id="local-6989586621679077634"><span class="annot"><span class="annottext">sawRain :: [WeatherParam] -&gt; [WeatherParam]
</span><a href="#local-6989586621679077634"><span class="hs-identifier hs-var hs-var">sawRain</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-669"></span><span>    </span><span class="annot"><a href="#local-6989586621679077634"><span class="hs-identifier hs-var">sawRain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#WindSpeed"><span class="hs-identifier hs-type">WindSpeed</span></a></span><span> </span><span id="local-6989586621679077631"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077631"><span class="hs-identifier hs-var">s</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077630"><span class="annot"><span class="annottext">[WeatherParam]
</span><a href="#local-6989586621679077630"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; WeatherParam
</span><a href="APRS.Types.html#Snowfall"><span class="hs-identifier hs-var">Snowfall</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077631"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">WeatherParam -&gt; [WeatherParam] -&gt; [WeatherParam]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[WeatherParam] -&gt; [WeatherParam]
</span><a href="#local-6989586621679077634"><span class="hs-identifier hs-var">sawRain</span></a></span><span> </span><span class="annot"><span class="annottext">[WeatherParam]
</span><a href="#local-6989586621679077630"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-670"></span><span>    </span><span class="annot"><a href="#local-6989586621679077634"><span class="hs-identifier hs-var">sawRain</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077629"><span class="annot"><span class="annottext">WeatherParam
</span><a href="#local-6989586621679077629"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679077628"><span class="annot"><span class="annottext">[WeatherParam]
</span><a href="#local-6989586621679077628"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WeatherParam
</span><a href="#local-6989586621679077629"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">WeatherParam -&gt; [WeatherParam] -&gt; [WeatherParam]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[WeatherParam] -&gt; [WeatherParam]
</span><a href="#local-6989586621679077634"><span class="hs-identifier hs-var">sawRain</span></a></span><span> </span><span class="annot"><span class="annottext">[WeatherParam]
</span><a href="#local-6989586621679077628"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-671"></span><span>
</span><span id="line-672"></span><span class="annot"><a href="APRS.Types.html#parseStatusPacket"><span class="hs-identifier hs-type">parseStatusPacket</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-type">APRSPacket</span></a></span><span>
</span><span id="line-673"></span><span id="parseStatusPacket"><span class="annot"><span class="annottext">parseStatusPacket :: Parser APRSPacket
</span><a href="APRS.Types.html#parseStatusPacket"><span class="hs-identifier hs-var hs-var">parseStatusPacket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-674"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&gt;'</span></span><span>
</span><span id="line-675"></span><span>  </span><span id="local-6989586621679077627"><span class="annot"><span class="annottext">Maybe Timestamp
</span><a href="#local-6989586621679077627"><span class="hs-identifier hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Timestamp -&gt; Maybe Timestamp
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Timestamp -&gt; Maybe Timestamp)
-&gt; Parser Timestamp -&gt; Parser (Maybe Timestamp)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Timestamp
</span><a href="APRS.Types.html#parseTimestamp"><span class="hs-identifier hs-var">parseTimestamp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser (Maybe Timestamp)
-&gt; Parser (Maybe Timestamp) -&gt; Parser (Maybe Timestamp)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp -&gt; Parser (Maybe Timestamp)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-676"></span><span>  </span><span id="local-6989586621679077626"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077626"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char -&gt; Parser Text String
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f [a]
</span><span class="hs-identifier hs-var">A.many1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'|'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'~'</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-677"></span><span>  </span><span class="annot"><span class="annottext">APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(APRSPacket -&gt; Parser APRSPacket)
-&gt; APRSPacket -&gt; Parser APRSPacket
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp -&gt; Text -&gt; APRSPacket
</span><a href="APRS.Types.html#StatusPacket"><span class="hs-identifier hs-var">StatusPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Timestamp
</span><a href="#local-6989586621679077627"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
forall a. IsString a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077626"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span>
</span><span id="line-679"></span><span class="annot"><a href="APRS.Types.html#parseMessagePacket"><span class="hs-identifier hs-type">parseMessagePacket</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-type">APRSPacket</span></a></span><span>
</span><span id="line-680"></span><span id="parseMessagePacket"><span class="annot"><span class="annottext">parseMessagePacket :: Parser APRSPacket
</span><a href="APRS.Types.html#parseMessagePacket"><span class="hs-identifier hs-var hs-var">parseMessagePacket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-681"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="hs-comment">-- message indicator</span><span>
</span><span id="line-682"></span><span>  </span><span id="local-6989586621679077625"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679077625"><span class="hs-identifier hs-var">rcpt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Address
</span><a href="APRS.Types.html#parseAddr"><span class="hs-identifier hs-var">parseAddr</span></a></span><span>
</span><span id="line-683"></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">A.many'</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.space</span></span><span> </span><span class="hs-comment">-- Technically, rpct is 9 characters with trailing space, but we're Posteling here a bit.</span><span>
</span><span id="line-684"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">':'</span></span><span> </span><span class="hs-comment">-- message separator</span><span>
</span><span id="line-685"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679077624"><span class="annot"><span class="annottext">MessageInfo
</span><a href="#local-6989586621679077624"><span class="hs-identifier hs-var">mi</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077623"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077623"><span class="hs-identifier hs-var">mid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser (MessageInfo, Text)
</span><a href="#local-6989586621679077622"><span class="hs-identifier hs-var">parseMI</span></a></span><span>
</span><span id="line-686"></span><span>
</span><span id="line-687"></span><span>  </span><span class="annot"><span class="annottext">APRSPacket -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(APRSPacket -&gt; Parser APRSPacket)
-&gt; APRSPacket -&gt; Parser APRSPacket
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Address -&gt; MessageInfo -&gt; Text -&gt; APRSPacket
</span><a href="APRS.Types.html#MessagePacket"><span class="hs-identifier hs-var">MessagePacket</span></a></span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679077625"><span class="hs-identifier hs-var">rcpt</span></a></span><span> </span><span class="annot"><span class="annottext">MessageInfo
</span><a href="#local-6989586621679077624"><span class="hs-identifier hs-var">mi</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077623"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-688"></span><span>
</span><span id="line-689"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-690"></span><span>    </span><span class="annot"><a href="#local-6989586621679077622"><span class="hs-identifier hs-type">parseMI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#MessageInfo"><span class="hs-identifier hs-type">MessageInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- returns the message ID</span><span>
</span><span id="line-691"></span><span>    </span><span id="local-6989586621679077622"><span class="annot"><span class="annottext">parseMI :: Parser (MessageInfo, Text)
</span><a href="#local-6989586621679077622"><span class="hs-identifier hs-var hs-var">parseMI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; MessageInfo -&gt; Parser (MessageInfo, Text)
</span><a href="#local-6989586621679077621"><span class="hs-identifier hs-var">parseACKNAK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;ack&quot;</span></span><span> </span><span class="annot"><span class="annottext">MessageInfo
</span><a href="APRS.Types.html#MessageACK"><span class="hs-identifier hs-var">MessageACK</span></a></span><span> </span><span class="annot"><span class="annottext">Parser (MessageInfo, Text)
-&gt; Parser (MessageInfo, Text) -&gt; Parser (MessageInfo, Text)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; MessageInfo -&gt; Parser (MessageInfo, Text)
</span><a href="#local-6989586621679077621"><span class="hs-identifier hs-var">parseACKNAK</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;rej&quot;</span></span><span> </span><span class="annot"><span class="annottext">MessageInfo
</span><a href="APRS.Types.html#MessageNAK"><span class="hs-identifier hs-var">MessageNAK</span></a></span><span> </span><span class="annot"><span class="annottext">Parser (MessageInfo, Text)
-&gt; Parser (MessageInfo, Text) -&gt; Parser (MessageInfo, Text)
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser (MessageInfo, Text)
</span><a href="#local-6989586621679077620"><span class="hs-identifier hs-var">parseMsg</span></a></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span>    </span><span class="annot"><a href="#local-6989586621679077621"><span class="hs-identifier hs-type">parseACKNAK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="APRS.Types.html#MessageInfo"><span class="hs-identifier hs-type">MessageInfo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#MessageInfo"><span class="hs-identifier hs-type">MessageInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>    </span><span id="local-6989586621679077621"><span class="annot"><span class="annottext">parseACKNAK :: Text -&gt; MessageInfo -&gt; Parser (MessageInfo, Text)
</span><a href="#local-6989586621679077621"><span class="hs-identifier hs-var hs-var">parseACKNAK</span></a></span></span><span> </span><span id="local-6989586621679077619"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077619"><span class="hs-identifier hs-var">pre</span></a></span></span><span> </span><span id="local-6989586621679077618"><span class="annot"><span class="annottext">MessageInfo
</span><a href="#local-6989586621679077618"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-695"></span><span>      </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><span class="hs-identifier hs-var">A.string</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077619"><span class="hs-identifier hs-var">pre</span></a></span><span>
</span><span id="line-696"></span><span>      </span><span id="local-6989586621679077617"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077617"><span class="hs-identifier hs-var">msgid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-identifier hs-var">A.takeText</span></span><span>
</span><span id="line-697"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Parser Text ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Parser Text ()) -&gt; Bool -&gt; Parser Text ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077617"><span class="hs-identifier hs-var">msgid</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-698"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Parser Text ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Parser Text ()) -&gt; Bool -&gt; Parser Text ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">Data.Text.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077617"><span class="hs-identifier hs-var">msgid</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-699"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Parser Text ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Parser Text ()) -&gt; Bool -&gt; Parser Text ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Text -&gt; Bool
</span><span class="hs-identifier hs-var">Data.Text.all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Char -&gt; Bool
</span><span class="hs-identifier hs-var">A.inClass</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;A-z0-9&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077617"><span class="hs-identifier hs-var">msgid</span></a></span><span>
</span><span id="line-700"></span><span>      </span><span class="annot"><span class="annottext">(MessageInfo, Text) -&gt; Parser (MessageInfo, Text)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MessageInfo
</span><a href="#local-6989586621679077618"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077617"><span class="hs-identifier hs-var">msgid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span>    </span><span class="annot"><a href="#local-6989586621679077620"><span class="hs-identifier hs-type">parseMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#MessageInfo"><span class="hs-identifier hs-type">MessageInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-703"></span><span>    </span><span id="local-6989586621679077620"><span class="annot"><span class="annottext">parseMsg :: Parser (MessageInfo, Text)
</span><a href="#local-6989586621679077620"><span class="hs-identifier hs-var hs-var">parseMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-704"></span><span>      </span><span id="local-6989586621679077615"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077615"><span class="hs-identifier hs-var">mtext</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">A.many'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'{'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'|'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'~'</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>      </span><span id="local-6989586621679077614"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077614"><span class="hs-identifier hs-var">mid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;{&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-identifier hs-var">A.takeText</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-comment">-- message ID is optional</span><span>
</span><span id="line-706"></span><span>      </span><span class="annot"><span class="annottext">(MessageInfo, Text) -&gt; Parser (MessageInfo, Text)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; MessageInfo
</span><a href="APRS.Types.html#Message"><span class="hs-identifier hs-var">Message</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Text
forall a. IsString a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077615"><span class="hs-identifier hs-var">mtext</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077614"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span>
</span><span id="line-708"></span><span class="annot"><a href="APRS.Types.html#parseTelemetry"><span class="hs-identifier hs-type">parseTelemetry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-type">APRSPacket</span></a></span><span>
</span><span id="line-709"></span><span id="parseTelemetry"><span class="annot"><span class="annottext">parseTelemetry :: Parser APRSPacket
</span><a href="APRS.Types.html#parseTelemetry"><span class="hs-identifier hs-var hs-var">parseTelemetry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-710"></span><span>  </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><span class="hs-identifier hs-var">A.string</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;T#&quot;</span></span><span>
</span><span id="line-711"></span><span>  </span><span id="local-6989586621679077613"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077613"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><a href="#local-6989586621679077612"><span class="hs-identifier hs-var">parseSeq</span></a></span><span>
</span><span id="line-712"></span><span>  </span><span id="local-6989586621679077611"><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679077611"><span class="hs-identifier hs-var">vals</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Double -&gt; Parser Text [Double]
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Double
</span><span class="hs-identifier hs-var">A.double</span></span><span> </span><span class="annot"><span class="annottext">Parser Double -&gt; Parser Text -&gt; Parser Double
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;,&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span>  </span><span id="local-6989586621679077608"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077608"><span class="hs-identifier hs-var">bits</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'1'</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-714"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679077607"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679077607"><span class="hs-identifier hs-var">bits'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; (Char -&gt; Bool) -&gt; (Char -&gt; Int) -&gt; ReadS Integer
forall a. Num a =&gt; a -&gt; (Char -&gt; Bool) -&gt; (Char -&gt; Int) -&gt; ReadS a
</span><span class="hs-identifier hs-var">readInt</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'1'</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679077606"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077606"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077606"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679077608"><span class="hs-identifier hs-var">bits</span></a></span><span>
</span><span id="line-715"></span><span>  </span><span class="annot"><span class="annottext">Text -&gt; [Double] -&gt; Word8 -&gt; Text -&gt; APRSPacket
</span><a href="APRS.Types.html#TelemetryPacket"><span class="hs-identifier hs-var">TelemetryPacket</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077613"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Double]
</span><a href="#local-6989586621679077611"><span class="hs-identifier hs-var">vals</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Word8
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679077607"><span class="hs-identifier hs-var">bits'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; APRSPacket) -&gt; Parser Text -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-identifier hs-var">A.takeText</span></span><span>
</span><span id="line-716"></span><span>
</span><span id="line-717"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-718"></span><span>    </span><span class="annot"><a href="#local-6989586621679077612"><span class="hs-identifier hs-type">parseSeq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-719"></span><span>    </span><span id="local-6989586621679077612"><span class="annot"><span class="annottext">parseSeq :: Parser Text
</span><a href="#local-6989586621679077612"><span class="hs-identifier hs-var hs-var">parseSeq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;MIC&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Parser Text
</span><span class="hs-identifier hs-var">A.string</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Parser Text
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;MIC&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span>               </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
forall a. IsString a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; Parser Text String -&gt; Parser Text
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.anyChar</span></span><span> </span><span class="annot"><span class="annottext">Parser Text String -&gt; Parser Text -&gt; Parser Text String
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;,&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-721"></span><span>               </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text
</span><span class="hs-identifier hs-var">A.takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Char -&gt; Bool
</span><span class="hs-identifier hs-var">A.inClass</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0-9&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Text -&gt; Parser Text -&gt; Parser Text
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;,&quot;</span></span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span class="annot"><a href="APRS.Types.html#parseMicE"><span class="hs-identifier hs-type">parseMicE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">A.Parser</span></span><span> </span><span class="annot"><a href="APRS.Types.html#APRSPacket"><span class="hs-identifier hs-type">APRSPacket</span></a></span><span>
</span><span id="line-724"></span><span id="parseMicE"><span class="annot"><span class="annottext">parseMicE :: Address -&gt; Parser APRSPacket
</span><a href="APRS.Types.html#parseMicE"><span class="hs-identifier hs-var hs-var">parseMicE</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="APRS.Types.html#Address"><span class="hs-identifier hs-type">Address</span></a></span><span> </span><span id="local-6989586621679077605"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077605"><span class="hs-identifier hs-var">call</span></a></span></span><span> </span><span id="local-6989586621679077604"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077604"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-725"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'`'</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-726"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077603"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077603"><span class="hs-identifier hs-var">lat</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077602"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077602"><span class="hs-identifier hs-var">mbits</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077601"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077601"><span class="hs-identifier hs-var">off</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077600"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077600"><span class="hs-identifier hs-var">sign</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077599"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077599"><span class="hs-identifier hs-var">_path</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; (Double, Int, Int, Int, Int)
</span><a href="APRS.MicE.html#micEDest"><span class="hs-identifier hs-var">M.micEDest</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077605"><span class="hs-identifier hs-var">call</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679077604"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-727"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679077597"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077597"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077596"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077596"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077595"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077595"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.anyChar</span></span><span>
</span><span id="line-728"></span><span>
</span><span id="line-729"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077594"><span class="annot"><span class="annottext">lon' :: Double
</span><a href="#local-6989586621679077594"><span class="hs-identifier hs-var hs-var">lon'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; (Int -&gt; Int) -&gt; Int -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Char -&gt; Int -&gt; Int
</span><a href="APRS.MicE.html#micELonD"><span class="hs-identifier hs-var">M.micELonD</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077597"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077601"><span class="hs-identifier hs-var">off</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span>
</span><span id="line-730"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; (Char -&gt; Int) -&gt; Char -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Char -&gt; Int
</span><a href="APRS.MicE.html#micELonM"><span class="hs-identifier hs-var">M.micELonM</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077596"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; (Char -&gt; Int) -&gt; Char -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077595"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">28</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">60</span></span><span class="hs-special">)</span><span>
</span><span id="line-731"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077591"><span class="annot"><span class="annottext">lon :: Double
</span><a href="#local-6989586621679077591"><span class="hs-identifier hs-var hs-var">lon</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077600"><span class="hs-identifier hs-var">sign</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077594"><span class="hs-identifier hs-var">lon'</span></a></span><span>
</span><span id="line-732"></span><span>
</span><span id="line-733"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679077590"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077590"><span class="hs-identifier hs-var">sp</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077589"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077589"><span class="hs-identifier hs-var">dc</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679077588"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077588"><span class="hs-identifier hs-var">se</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Parser Text Char -&gt; Parser Text String
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.anyChar</span></span><span>
</span><span id="line-734"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077587"><span class="annot"><span class="annottext">speed10 :: Int
</span><a href="#local-6989586621679077587"><span class="hs-identifier hs-var hs-var">speed10</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077590"><span class="hs-identifier hs-var">sp</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">28</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-735"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679077586"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077586"><span class="hs-identifier hs-var">speed1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679077585"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077585"><span class="hs-identifier hs-var">course100</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077589"><span class="hs-identifier hs-var">dc</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">28</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int, Int)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`quotRem`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-736"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077583"><span class="annot"><span class="annottext">course' :: Int
</span><a href="#local-6989586621679077583"><span class="hs-identifier hs-var hs-var">course'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077588"><span class="hs-identifier hs-var">se</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">28</span></span><span>
</span><span id="line-737"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077582"><span class="annot"><span class="annottext">speed :: Int
</span><a href="#local-6989586621679077582"><span class="hs-identifier hs-var hs-var">speed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077587"><span class="hs-identifier hs-var">speed10</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077586"><span class="hs-identifier hs-var">speed1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">800</span></span><span>
</span><span id="line-738"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077581"><span class="annot"><span class="annottext">course :: Int
</span><a href="#local-6989586621679077581"><span class="hs-identifier hs-var hs-var">course</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077583"><span class="hs-identifier hs-var">course'</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077585"><span class="hs-identifier hs-var">course100</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-739"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679077580"><span class="annot"><span class="annottext">ext :: PosExtension
</span><a href="#local-6989586621679077580"><span class="hs-identifier hs-var hs-var">ext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double -&gt; PosExtension
</span><a href="APRS.Types.html#PosECourseSpeed"><span class="hs-identifier hs-var">PosECourseSpeed</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077581"><span class="hs-identifier hs-var">course</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">400</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077581"><span class="hs-identifier hs-var">course</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">400</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077581"><span class="hs-identifier hs-var">course</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077582"><span class="hs-identifier hs-var">speed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-740"></span><span>  </span><span id="local-6989586621679077579"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077579"><span class="hs-identifier hs-var">sym</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.anyChar</span></span><span>
</span><span id="line-741"></span><span>  </span><span id="local-6989586621679077578"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077578"><span class="hs-identifier hs-var">tbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Text Char
</span><span class="hs-identifier hs-var">A.anyChar</span></span><span>
</span><span id="line-742"></span><span>  </span><span id="local-6989586621679077577"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077577"><span class="hs-identifier hs-var">alt</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Parser Double
</span><a href="#local-6989586621679077576"><span class="hs-identifier hs-var">micalt</span></a></span><span>
</span><span id="line-743"></span><span>  </span><span class="annot"><span class="annottext">Symbol -&gt; Int -&gt; Position -&gt; Text -&gt; APRSPacket
</span><a href="APRS.Types.html#MicEPacket"><span class="hs-identifier hs-var">MicEPacket</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Symbol
</span><a href="APRS.Types.html#Symbol"><span class="hs-identifier hs-var">Symbol</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077578"><span class="hs-identifier hs-var">tbl</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679077579"><span class="hs-identifier hs-var">sym</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679077602"><span class="hs-identifier hs-var">mbits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double, Double, Double, PosExtension) -&gt; Position
</span><a href="APRS.Types.html#Position"><span class="hs-identifier hs-var">Position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077603"><span class="hs-identifier hs-var">lat</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077591"><span class="hs-identifier hs-var">lon</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679077577"><span class="hs-identifier hs-var">alt</span></a></span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10000</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">PosExtension
</span><a href="#local-6989586621679077580"><span class="hs-identifier hs-var">ext</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; APRSPacket) -&gt; Parser Text -&gt; Parser APRSPacket
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-identifier hs-var">A.takeText</span></span><span>
</span><span id="line-744"></span><span>
</span><span id="line-745"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679077576"><span class="annot"><span class="annottext">micalt :: Parser Double
</span><a href="#local-6989586621679077576"><span class="hs-identifier hs-var hs-var">micalt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Parser Text Char
</span><span class="hs-identifier hs-var">A.satisfy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\''</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'`'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">']'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&gt;'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'T'</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Text Char -&gt; Parser Double -&gt; Parser Double
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Double
</span><a href="#local-6989586621679077575"><span class="hs-identifier hs-var">decodeAlt</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Double -&gt; Parser Double -&gt; Parser Double
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Parser Double
</span><a href="#local-6989586621679077575"><span class="hs-identifier hs-var">decodeAlt</span></a></span><span>
</span><span id="line-746"></span><span>        </span><span id="local-6989586621679077575"><span class="annot"><span class="annottext">decodeAlt :: Parser Double
</span><a href="#local-6989586621679077575"><span class="hs-identifier hs-var hs-var">decodeAlt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Parser Double
</span><a href="APRS.Types.html#parseB91Seg"><span class="hs-identifier hs-var">parseB91Seg</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">Parser Double -&gt; Parser Text -&gt; Parser Double
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Parser Text
</span><span class="hs-string">&quot;}&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parser Double -&gt; Parser Double -&gt; Parser Double
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Parser Double
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10000</span></span><span> </span><span class="hs-comment">-- 10km = sea level.</span><span>
</span><span id="line-747"></span></pre></body></html>